{"version":3,"sources":["webpack://Movai/webpack/universalModuleDefinition","webpack://Movai/webpack/bootstrap","webpack://Movai/external \"@babel/runtime/helpers/esm/defineProperty\"","webpack://Movai/external \"@babel/runtime/helpers/esm/classCallCheck\"","webpack://Movai/external \"@babel/runtime/helpers/esm/createClass\"","webpack://Movai/external \"lodash\"","webpack://Movai/external \"@babel/runtime/regenerator\"","webpack://Movai/external \"@babel/runtime/helpers/esm/asyncToGenerator\"","webpack://Movai/external \"rxjs\"","webpack://Movai/external \"@babel/runtime/helpers/esm/slicedToArray\"","webpack://Movai/external \"jwt-decode\"","webpack://Movai/external \"monet\"","webpack://Movai/external \"@babel/runtime/helpers/esm/typeof\"","webpack://Movai/./src/Authentication/Authentication.js","webpack://Movai/./src/Utils/Utils.js","webpack://Movai/./src/AuthWebSocket/AuthWebSocket.js","webpack://Movai/./src/Database/Database.js","webpack://Movai/./src/Database/WSSub.js","webpack://Movai/./src/Database/MasterDB.js","webpack://Movai/./src/Style/Style.js","webpack://Movai/./resources/fonts/movai.woff","webpack://Movai/./src/UndoManager/UndoManager.js","webpack://Movai/./src/Clipboard/Clipboard.js","webpack://Movai/./src/User/User.js","webpack://Movai/./src/Database/Models/BaseModel.js","webpack://Movai/./src/Database/Manager/DataManagerBase.js","webpack://Movai/./src/Rest/RestBase.js","webpack://Movai/./src/Rest/WithAuth.js","webpack://Movai/./src/Rest/Rest.js","webpack://Movai/./src/Database/Snapshot.js","webpack://Movai/./src/Database/Document.js","webpack://Movai/./src/Database/Workspace.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","Authentication","message","this","statusText","token","localStorage","getItem","refreshToken","getToken","jwtDecode","auth_token","refresh_token","getRefreshToken","error","access_token","login","username","password","remember","a","removeItem","sessionStorage","headers","fetch","method","body","JSON","stringify","response","status","json","data","setItem","logout","checkLogin","tokenRemember","sessionFlag","tokenData","Date","getTime","Utils","x","Maybe","fromNull","prop","obj","f","g","dot","ofNull","init","end","map","e","orSome","ans","j","push","b","Math","floor","random","str","normalize","replace","toLowerCase","array","groupFunction","forEach","charAt","toUpperCase","slice","prefix","keys","reduce","acc","k","pre","length","assign","flattenObject","AuthException","AuthWebSocket","url","wsUrl","onOpen","onClose","onError","onMessage","connectionHandler","evt","console","log","connected","socket","timerId","clearTimeout","setTimeout","createSocket","_onOpen","_onClose","_onError","_onMessage","_connectionHandler","sock","then","res","URL","params","URLSearchParams","search","set","WebSocket","toString","onopen","onerror","onclose","onmessage","send","self","sub_interval","undefined","setInterval","readyState","clearInterval","close","Database","websocket","WS_API","dispatch","code","connect","timeout","parse","err","patterns","is_pattern","one_shot","includes","event","callbacks","pattern","Promise","resolve","reject","event_name","callback","evt_callbacks","_pattern","evt_callback","_send","_callbacks","scope","split","REST_API","Authorization","packageName","formData","FormData","append","cloudFunction","func","args","newValue","componentName","key_workspace","Workspace","host","location","hostname","port","isHttps","protocol","WSSub","CLOSED","onAuthError","RECONN_TIMEOUT","getOrCreate","pushCallback","sub_callbacks","command","_sufix","retry","RETRIES","Error","getState","OPEN","RESEND_TIMEOUT","is_command","_map","cb","reSubscribe","NORMAL_CLOSE_EVT","reConnect","msg","values","commands","LIST","EXECUTE","_prefix","SUBSCRIBE","fmtMessage","initSocket","addSubscriberCallback","addEventCallback","Array","from","UNSUBSCRIBE","remote_callback","Map","MasterDB","Style","UndoManager","size","undoStack","Queue","redoStack","undoAbleAction","doAction","pop","undoAction","UndoAbleActionBuilder","_doAction","_undoAction","lambda","some","queue","el","shift","Clipboard","instance","_data","copyKey","inst","write","read","User","baseUrl","currTime","timestamp","TIMEOUT","ok","getData","Superuser","origin","getTokenData","BaseModel","manager","model","database","_subscribe","db","subscribe","_onDataChange","_onDataLoad","default_pattern","Scope","Name","_patterns","isArray","id","_cache","add","unsubscribe","path","new_obj","lodash","isEmpty","omit","up_path","removeEmpty","join","entry","_get_or_create","remove","merge","_subject","next","nr_patterns","db_state","db_states","ready","_subject_state","freeze","loading","Subject","BehaviorSubject","_db_state","_validatePatterns","_initialize","complete","DataManagerBase","models","_subscribeModelsReady","onReady","_setModelReady","isReady","subscribeTo","onUpdate","RestBase","output","entries","encodeURIComponent","encodeURI","customHeaders","getUrl","payload","_request","post","cbName","fn","validScope","validKey","validateVar","Rest","props","handler","__checkLogin","target","Reflect","Proxy","withAuth","Snapshot","source","src","workspace","type","version","Document","uri","apiVersion","_parseArgs","subscriber","_workspace","_type","_name","_version","v1","v2","put","resubscribe","readOnly","destroy","trgWorkspace","srcWorkspace","getAll","_init","Boolean","Label"],"mappings":"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","file":"dist/index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Movai\"] = factory();\n\telse\n\t\troot[\"Movai\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","module.exports = require(\"@babel/runtime/helpers/esm/defineProperty\");","module.exports = require(\"@babel/runtime/helpers/esm/classCallCheck\");","module.exports = require(\"@babel/runtime/helpers/esm/createClass\");","module.exports = require(\"lodash\");","module.exports = require(\"@babel/runtime/regenerator\");","module.exports = require(\"@babel/runtime/helpers/esm/asyncToGenerator\");","module.exports = require(\"rxjs\");","module.exports = require(\"@babel/runtime/helpers/esm/slicedToArray\");","module.exports = require(\"jwt-decode\");","module.exports = require(\"monet\");","module.exports = require(\"@babel/runtime/helpers/esm/typeof\");","import jwtDecode from \"jwt-decode\";\n\nconst Authentication = {};\n\nAuthentication.AuthException = function (message) {\n  this.message = message;\n  this.statusText = message;\n  this.name = \"AuthException\";\n};\n\nAuthentication.getToken = () => {\n  const token = window.localStorage.getItem(\"movai.token\");\n  return token ? token : false;\n};\n\nAuthentication.getRefreshToken = () => {\n  const refreshToken = window.localStorage.getItem(\"movai.refreshToken\");\n  return refreshToken ? refreshToken : false;\n};\n\nAuthentication.getTokenData = () => {\n  try {\n    const token = Authentication.getToken();\n    const message = jwtDecode(token).message;\n\n    const tokenData = {\n      message: message,\n      auth_token: false,\n      refresh_token: Authentication.getRefreshToken(),\n      error: false,\n      access_token: token\n    };\n\n    return tokenData;\n  } catch (error) {\n    return {\n      message: {},\n      error: true\n    };\n  }\n};\n\nAuthentication.login = async (username, password, remember) => {\n  // Cleanup...\n  window.localStorage.removeItem(\"movai.token\");\n  window.localStorage.removeItem(\"movai.refreshToken\");\n  window.localStorage.removeItem(\"movai.tokenRemember\");\n  window.sessionStorage.removeItem(\"movai.session\");\n\n  let headers = {};\n  headers[\"Content-Type\"] = \"application/json\";\n\n  const url = `/token-auth/`;\n\n  try {\n    const response = await fetch(url, {\n      method: \"POST\",\n      headers,\n      body: JSON.stringify({\n        username: username,\n        password: password,\n        remember: remember\n      })\n    });\n\n    const { status } = response;\n    let data = await response.json();\n\n    if (status === 200) {\n      window.localStorage.setItem(\"movai.token\", data[\"access_token\"]);\n      window.localStorage.setItem(\"movai.refreshToken\", data[\"refresh_token\"]);\n      window.localStorage.setItem(\n        \"movai.tokenRemember\",\n        remember == \"undefined\" ? false : remember\n      );\n      window.sessionStorage.setItem(\"movai.session\", true);\n    }\n\n    return data;\n  } catch (e) {\n    // ToDo Add exception error message\n    throw e;\n  }\n};\n\nAuthentication.logout = () => {\n  window.localStorage.removeItem(\"movai.token\");\n  window.localStorage.removeItem(\"movai.refreshToken\");\n  window.localStorage.removeItem(\"movai.tokenRemember\");\n  window.sessionStorage.removeItem(\"movai.session\");\n};\n\nAuthentication.checkLogin = async () => {\n  const token = window.localStorage.getItem(\"movai.token\");\n  const refreshToken = window.localStorage.getItem(\"movai.refreshToken\");\n  const tokenRemember = window.localStorage.getItem(\"movai.tokenRemember\");\n  const sessionFlag = window.sessionStorage.getItem(\"movai.session\");\n\n  if (token === null || refreshToken === null) {\n    return false;\n  }\n\n  let tokenData = null;\n  try {\n    tokenData = jwtDecode(token);\n  } catch (e) {\n    return false;\n  }\n\n  // Check if token expired\n  if (tokenData[\"exp\"] > new Date().getTime() / 1000) {\n    return true;\n  }\n\n  // Check SessionStorage flag\n  if (tokenRemember == \"false\" && sessionFlag === null) {\n    Authentication.logout();\n    return false;\n  }\n\n  // Token has expired... Get new Token\n  if (refreshToken) {\n    // Try to get new token\n    try {\n      // Refresh Token\n      const refreshTokenData = jwtDecode(refreshToken);\n      if (refreshTokenData[\"exp\"] < new Date().getTime() / 1000) {\n        throw \"refresh token has expired\";\n      }\n\n      const url = `/token-refresh/`;\n      const headers = { \"Content-Type\": \"application/json\" };\n      const response = await fetch(url, {\n        method: \"POST\",\n        headers,\n        body: JSON.stringify({ token: refreshToken })\n      });\n\n      const { status } = response;\n      let data = await response.json();\n\n      if (status === 200) {\n        window.localStorage.setItem(\"movai.token\", data[\"access_token\"]);\n        window.localStorage.setItem(\n          \"movai.refreshToken\",\n          data[\"refresh_token\"]\n        );\n        return true;\n      }\n    } catch (e) {\n      // Pass\n    }\n  }\n\n  return false;\n};\n\nexport default Authentication;\n","import { Maybe } from \"monet\";\n\nconst Utils = {};\n\nUtils.ofNull = x => Maybe.fromNull(x);\n\nUtils.getter = prop => obj => obj[prop];\n\nUtils.dot = f => g => x => f(g(x));\n\nUtils.maybeGet = prop => Utils.dot(Utils.ofNull)(Utils.getter(prop));\n\nUtils.range = (init, end) => {\n  const { i, e } = Maybe.fromNull(end)\n    .map(x => ({ i: init, e: end }))\n    .orSome({ i: 0, e: init });\n  const ans = [];\n  for (let j = i; j < e; j++) ans.push(j);\n  return ans;\n};\n\nUtils.randomInt = (a, b) => Math.floor(Utils.random(a, b));\n\nUtils.random = (a, b) => {\n  const { init, end } = Maybe.fromNull(b)\n    .map(x => ({ init: a, end: b }))\n    .orSome({ init: 0, end: a });\n  return init + (end - init) * Math.random();\n};\n\nUtils.normalizeStr = str => {\n  // from https://stackoverflow.com/questions/990904/remove-accents-diacritics-in-a-string-in-javascript\n  return str\n    .normalize(\"NFD\")\n    .replace(/[\\u0300-\\u036f]/g, \"\")\n    .toLowerCase();\n};\n\n/**\n *\n * @param {*} array\n * @param {*} groupFunction : function x => group class;\n *\n * Usage example:\n *\n * groupBy([1,2,3,4,5,6,7,8,9], x => x % 3) // {0: [3,6,9], 1:[1,4,7], 2:[2,5,8]}\n */\nUtils.groupBy = (array, groupFunction) => {\n  const ans = {};\n  array.forEach(x => {\n    const key = groupFunction(x);\n    if (!ans[key]) ans[key] = [];\n    ans[key].push(x);\n  });\n  return ans;\n};\n\n// From https://flaviocopes.com/how-to-uppercase-first-letter-javascript/\nUtils.capitalize = s => {\n  if (typeof s !== \"string\") return \"\";\n  return s.charAt(0).toUpperCase() + s.slice(1);\n};\n\n/**\n * Positive mod function\n */\nUtils.mod = (x, n) => ((x % n) + n) % n;\n\n/**\n * flatten an object\n * https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/flattenObject.md\n */\nUtils.flattenObject = (obj, prefix = \"\") =>\n  Object.keys(obj).reduce((acc, k) => {\n    const pre = prefix.length ? prefix + \".\" : \"\";\n\n    if (typeof obj[k] === \"object\")\n      Object.assign(acc, Utils.flattenObject(obj[k], pre + k));\n    else acc[pre + k] = obj[k];\n\n    return acc;\n  }, {});\n\nexport default Utils;\n","import Authentication from \"../Authentication/Authentication\";\n\nconst { checkLogin, getToken, AuthException } = Authentication;\n\nexport default class AuthWebSocket {\n  constructor({\n    url = this.wsUrl,\n    onOpen = null,\n    onClose = null,\n    onError = null,\n    onMessage = null,\n    connectionHandler = null\n  }) {\n    this.onOpen = onOpen === null ? this._onOpen : onOpen;\n    this.onClose = onClose === null ? this._onClose : onClose;\n    this.onError = onError === null ? this._onError : onError;\n    this.onMessage = onMessage === null ? this._onMessage : onMessage;\n    this.connectionHandler =\n      connectionHandler === null ? this._connectionHandler : connectionHandler;\n\n    this.wsUrl = url;\n    this.socket = false;\n    this.timerId = false;\n    this.connected = false;\n  }\n\n  _onOpen = evt => {\n    console.log(\"Socket Open: \", evt);\n  };\n\n  _onClose = evt => {\n    console.log(\"Socket Close: \", evt);\n\n    this.connected = false;\n\n    // Deal with reconnecting the socket\n    this.socket = null;\n    if (this.timerId) {\n      clearTimeout(this.timerId);\n    }\n    this.timerId = setTimeout(() => {\n      this.createSocket();\n    }, 5000);\n  };\n\n  _onError = evt => {\n    this.connected = false;\n    console.log(\"Socket Error: \", evt);\n  };\n\n  _onMessage = evt => {\n    console.log(\"Socket Message: \", evt);\n  };\n\n  _connectionHandler = value => {\n    console.log(\"Invalid Token, no handler specified! \", value);\n  };\n\n  createSocket(url = false) {\n    let sock = false;\n\n    checkLogin()\n      .then(res => {\n        if (!res) {\n          throw new AuthException(\"login error\");\n        }\n\n        url = url !== false ? url : this.wsUrl;\n        //const wsUrl = `${url}?token=${getToken()}`;\n\n        let wsUrl = new URL(url);\n        let params = new URLSearchParams(wsUrl.search.slice(1));\n        params.set(\"token\", getToken());\n        wsUrl.search = params;\n\n        sock = new WebSocket(wsUrl.toString());\n        sock.onopen = this.onOpen;\n        sock.onerror = this.onError;\n        sock.onclose = this.onClose;\n        sock.onmessage = this.onMessage;\n\n        this.socket = sock;\n      })\n      .catch(e => {\n        if (e.name === \"AuthException\") {\n          this.connectionHandler(false);\n        }\n      });\n  }\n\n  send(data) {\n    checkLogin()\n      .then(res => {\n        if (!res) {\n          throw new AuthException(\"login error\");\n        }\n\n        this.socket.send(data);\n      })\n      .catch(e => {\n        switch (e.name) {\n          case \"AuthException\":\n            this.connectionHandler(false);\n            break;\n\n          case \"InvalidStateError\":\n            // In case of the socket is not-ready, re-try sending the message until success\n            var self = this;\n            let sub_interval = undefined;\n            sub_interval = setInterval(\n              () => {\n                if (self.socket.readyState === 1) {\n                  clearInterval(sub_interval);\n                  self.socket.send(data);\n                }\n              },\n              400,\n              sub_interval\n            );\n            break;\n        }\n      });\n  }\n\n  close() {\n    if (this.socket) {\n      this.socket.close();\n      clearTimeout(this.timerId);\n      this.connected = false;\n    }\n  }\n}\n","import Authentication from \"../Authentication/Authentication\";\nimport AuthWebSocket from \"../AuthWebSocket/AuthWebSocket\";\nconst { getToken, AuthException, checkLogin } = Authentication;\n\nclass Database {\n  constructor() {\n    this.host = `${window.location.hostname}:${window.location.port}`;\n    const isHttps = window.location.protocol === \"https:\";\n    this.WS_API = `${isHttps ? \"wss\" : \"ws\"}://${this.host}/ws/subscriber`;\n    this.REST_API = `${window.location.protocol}//${this.host}/api/v1/`;\n    this.callbacks = {};\n    this.evt_callbacks = {};\n    this.timeout = 3000;\n    this.websocket = undefined;\n    this.connect();\n  }\n\n  connect = () => {\n    this.websocket = new AuthWebSocket({\n      url: this.WS_API,\n      onOpen: this.onOpen,\n      onClose: this.onClose,\n      onError: this.onError,\n      onMessage: this.onMessage,\n      connectionHandler: null\n    });\n    this.websocket.createSocket();\n  };\n\n  onOpen = evt => {\n    this.dispatch(\"onopen\", undefined);\n  };\n\n  onClose = evt => {\n    this.dispatch(\"onclose\", undefined);\n    if (evt.code !== 1000) {\n      window.setTimeout(this.connect(), this.timeout);\n    }\n  };\n\n  onMessage = evt => {\n    let data;\n    try {\n      data = JSON.parse(evt.data);\n    } catch (err) {\n      console.error(err);\n      return;\n    }\n    if (data.error) {\n      console.error(data.error);\n      return;\n    }\n    let patterns = data.patterns;\n    let is_pattern = true;\n    let one_shot = false;\n    if ([\"list\", \"unsubscribe\", \"subscribe\"].includes(data.event)) {\n      patterns = patterns.map(p => {\n        if (data.event === \"unsubscribe\") {\n          delete this.callbacks[JSON.stringify(p)];\n        }\n        return data.event + \"/\" + JSON.stringify(p);\n      });\n      if (data.event === \"list\") {\n        patterns = [\"list\"];\n      }\n\n      is_pattern = false;\n      one_shot = true;\n    }\n\n    patterns.map(pattern => {\n      this.dispatch(pattern, data, is_pattern, one_shot);\n    });\n  };\n\n  /////TEST\n  checkTest = (pattern, data, is_pattern, one_shot) => {\n    return new Promise((resolve, reject) => {\n      this.dispatch(pattern, data, is_pattern, one_shot);\n      if (true) {\n        resolve(\"DONE\");\n      }\n    });\n  };\n\n  onError = evt => {\n    this.dispatch(\"onerror\", undefined);\n  };\n\n  /* Subscribe to websocket events onopen, onclose, onerror*/\n  onEvent = (event_name, callback = undefined) => {\n    this.evt_callbacks[event_name] = this.evt_callbacks[event_name] || [];\n    this.evt_callbacks[event_name].push(callback);\n  };\n\n  close = () => this.websocket.close();\n\n  /* Subscribe to redis pattern */\n  subscribe = (_pattern, callback = undefined, evt_callback = undefined) => {\n    const message = { event: \"subscribe\", pattern: _pattern };\n    let pattern = JSON.stringify(_pattern);\n    this.callbacks[pattern] = this.callbacks[pattern] || [];\n    this.callbacks[pattern].push(callback);\n    if (evt_callback) {\n      this.evt_callbacks[\"subscribe/\" + pattern] =\n        this.evt_callbacks[\"subscribe\" + pattern] || [];\n      this.evt_callbacks[\"subscribe/\" + pattern].push(evt_callback);\n    }\n    this._send(message);\n  };\n\n  unsubscribe = (_pattern, evt_callback = undefined) => {\n    console.log(\"Unsubscribe called \" + JSON.stringify(_pattern));\n    const message = { event: \"unsubscribe\", pattern: _pattern };\n    var pattern = JSON.stringify(_pattern);\n    if (evt_callback) {\n      this.evt_callbacks[\"unsubscribe/\" + pattern] =\n        this.evt_callbacks[\"unsubscribe/\" + pattern] || [];\n      this.evt_callbacks[\"unsubscribe/\" + pattern].push(evt_callback);\n    }\n    this._send(message);\n  };\n\n  /* List all subscribed patterns */\n  list = (evt_callback = undefined) => {\n    const message = { event: \"list\" };\n    this.evt_callbacks[\"list\"] = this.evt_callbacks[\"list\"] || [];\n    this.evt_callbacks[\"list\"].push(evt_callback);\n    this._send(message);\n  };\n\n  _send = message => {\n    this.websocket.send(JSON.stringify(message));\n  };\n\n  /* Trigger callbacks attached to patterns and events*/\n  dispatch = (_pattern, message, is_pattern = false, one_shot = false) => {\n    /*if is_pattern is false then pattern is an event thus trigger evt_callbacks */\n    let _callbacks = undefined;\n    var pattern = _pattern;\n    if (is_pattern === true) {\n      pattern = JSON.stringify(_pattern);\n      _callbacks = this.callbacks[pattern];\n    } else {\n      _callbacks = this.evt_callbacks[pattern];\n    }\n\n    if (_callbacks === undefined) return;\n    for (let i = 0; i < _callbacks.length; i++) {\n      if (typeof _callbacks[i] === \"function\") {\n        _callbacks[i](message);\n      }\n    }\n    if (_callbacks) {\n      if (one_shot === true) {\n        _callbacks = [];\n      } else {\n        //NOTHING\n      }\n    }\n  };\n\n  /**\n   * STOPPED HERE\n   */\n\n  /* Get value from key in Var, scope fleet or global */\n  getVar = (key, callback = undefined, scope = \"global\") => {\n    if (![\"global\", \"fleet\"].includes(scope)) {\n      throw \"Only fleet and global scopes available.\";\n    }\n    if (scope === \"fleet\") {\n      // key format: robot_name@key_name\n      if (key.split(\"@\").length < 2) {\n        throw \"Wrong key format (robot_name@key_name)\";\n      }\n    }\n    const url = this.REST_API + \"database/\" + scope + \"/\" + key + \"/\";\n\n    checkLogin().then(res => {\n      fetch(url)\n        .then(response => response.json())\n\n        .then(data => {\n          if (callback) {\n            callback(data);\n          } else {\n            //NOTHING\n          }\n        });\n    });\n  };\n\n  /* Set value from key in Var, scope fleet or global */\n  setVar = (key, value, callback = undefined, scope = \"global\") => {\n    if (![\"global\", \"fleet\"].includes(scope)) {\n      throw \"Only fleet and global scopes available.\";\n    }\n    if (scope === \"fleet\") {\n      // key format: robot_name@key_name\n      const values = key.split(\"@\");\n      if (key.split(\"@\").length < 2) {\n        throw \"Wrong key format (robot_name@key_name)\";\n      }\n    }\n    const data = { key: key, scope: scope, value: value };\n    const url = this.REST_API + \"database/\";\n\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"POST\",\n        body: JSON.stringify(data),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          callback(res);\n        }\n      });\n    });\n  };\n\n  /**\n   * GET value from url\n   * @param url String\n   * @param callback function\n   * @memberof Database\n   */\n  get = (url, callback = undefined) => {\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, e);\n            });\n        }\n      });\n    });\n  };\n\n  /**\n   * Set value from key in Scope\n   * @param scope String\n   * @param name String - Instance Name\n   * @param key String - Key to override\n   * @param value Obj\n   * @param callback function\n   * @memberof Database\n   */\n  post = (scope, name, key, value, callback = undefined) => {\n    let url = this.REST_API + scope + \"/\" + name + \"/\";\n    if (name === undefined) {\n      url = this.REST_API + scope + \"/\";\n    }\n\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"POST\",\n        body: JSON.stringify({ key: key, data: value }),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, e);\n            });\n        }\n      });\n    });\n  };\n\n  upload = (packageName, key, value, callback = undefined) => {\n    const url = `${this.REST_API}upload/${packageName}/`;\n    const formData = new FormData();\n    formData.append(\"name\", key);\n    formData.append(`data`, value);\n    fetch(url, { method: \"POST\", body: formData })\n      .then(res => res.json())\n      .then(callback);\n  };\n\n  /**\n   * Update key\n   * @param scope String\n   * @param name String - Instance Name\n   * @param value Obj\n   * @param callback function\n   * @memberof Database\n   */\n  put = (scope, name, value, callback = undefined) => {\n    let url = this.REST_API + scope + \"/\" + name + \"/\";\n    console.log(\"database put\", url);\n    if (name === undefined) {\n      url = this.REST_API + scope + \"/\";\n    }\n\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"PUT\",\n        body: JSON.stringify(value),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, res);\n\n              if (process.env.NODE_ENV === \"development\") {\n                alert(\n                  \"Development Mode \\n\" +\n                    \"Status: \" +\n                    res.status +\n                    \"\\n\" +\n                    \"Error: \" +\n                    res.statusText\n                );\n              }\n            });\n        }\n      });\n    });\n  };\n\n  /**\n   * Set value from key in Scope\n   * @param scope String\n   * @param name String - Instance Name\n   * @param key String - Key to override\n   * @param value Obj\n   * @param callback function\n   * @memberof Database\n   */\n  delete = (scope, name, callback = undefined, data = {}) => {\n    let url = this.REST_API + scope + \"/\" + name + \"/\";\n    if (name === undefined) {\n      url = this.REST_API + scope + \"/\";\n      return;\n    }\n\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"DELETE\",\n        body: JSON.stringify(data),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, res);\n\n              if (process.env.NODE_ENV === \"development\") {\n                alert(\n                  \"Development Mode \\n\" +\n                    \"Status: \" +\n                    res.status +\n                    \"\\n\" +\n                    \"Error: \" +\n                    res.statusText\n                );\n              }\n            });\n        }\n      });\n    });\n  };\n\n  /**\n   * Set value from key in Scope\n   * @param cloudFunction String - callback name\n   * @param func String - Function in the callback. default \"\"\n   * @param args Object - Args {key:value}... key is the param in the function\n   * @param callback func - Callback to parse the response\n   * @memberof Database\n   */\n  cloudFunction = (cloudFunction, func = \"\", args, callback = undefined) => {\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      const url = this.REST_API + \"function/\" + cloudFunction + \"/\";\n      fetch(url, {\n        method: \"POST\",\n        body: JSON.stringify({ func: func, args: args }),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res.json().then(data => callback(data));\n        }\n      });\n    });\n  };\n\n  /**\n   * Set tabs in a currentUser\n   * @param scope String\n   * @param name String - Instance Name\n   * @param key String - Key to override\n   * @param value Obj\n   * @param callback function\n   * @memberof Database\n   */\n  postTabs = (name, value, callback = undefined) => {\n    let scope = \"User\";\n    let url = this.REST_API + scope + \"/\" + name + \"/\";\n    if (name === undefined) {\n      url = this.REST_API + scope + \"/\";\n      return;\n    }\n    let newValue = value.map(obj => {\n      return { componentName: obj.componentName, name: obj.name };\n    });\n    const key_workspace = {\n      Workspace: \"*\"\n    };\n\n    checkLogin().then(res => {\n      fetch(url, {\n        method: \"POST\",\n        body: JSON.stringify({ key: key_workspace, data: newValue }),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, res);\n\n              if (process.env.NODE_ENV === \"development\") {\n                alert(\n                  \"Development Mode \\n\" +\n                    \"Status: \" +\n                    res.status +\n                    \"\\n\" +\n                    \"Error: \" +\n                    res.statusText\n                );\n              }\n            });\n        }\n      });\n    });\n  };\n}\n\nexport default Database;\n","import AuthWebSocket from \"../AuthWebSocket/AuthWebSocket\";\nimport Authentication from \"../Authentication/Authentication\";\nconst { getToken, AuthException, checkLogin } = Authentication;\n\n/**\n * WSSub - class to handle redis subscribers using authenticated websockets\n */\nclass WSSub {\n  constructor() {\n    this.host = `${window.location.hostname}:${window.location.port}`;\n    const isHttps = window.location.protocol === \"https:\";\n    this.url = `${isHttps ? \"wss\" : \"ws\"}://${this.host}/ws/subscriber`;\n    this.REST_API = `${window.location.protocol}//${this.host}/api/v1/`;\n    this.RECONN_TIMEOUT = 3000;\n    this.RESEND_TIMEOUT = 1000;\n    this.RETRIES = 3;\n    this.NORMAL_CLOSE_EVT = 1000;\n\n    // supported commands\n    this.commands = {\n      SUBSCRIBE: \"subscribe\",\n      UNSUBSCRIBE: \"unsubscribe\",\n      LIST: \"list\",\n      EXECUTE: \"execute\"\n    };\n\n    this.websocket = null;\n    // map with callbacks related with pattern subscription\n    this.sub_callbacks = new Map();\n    // map with callbacks related with event subscription\n    this.evt_callbacks = new Map();\n  }\n\n  /**\n   * get the connection state\n   * https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/readyState\n   */\n  getState = () => {\n    return this.websocket?.socket?.readyState || WebSocket.CLOSED;\n  };\n\n  /**\n   * initialize the socket instance\n   */\n\n  initSocket = () => {\n    if (this.websocket) return this;\n\n    const { url, onOpen, onClose, onError, onMessage, onAuthError } = this;\n\n    // TODO extend WSSub from AuthWebSocket instead\n    this.websocket = new AuthWebSocket({\n      url,\n      onOpen,\n      onClose,\n      onError,\n      onMessage,\n      connectionHandler: onAuthError\n    });\n\n    this.connect();\n    return this;\n  };\n\n  /**\n   * connection initialization\n   */\n  connect = () => {\n    this.websocket.createSocket();\n\n    return this;\n  };\n\n  /**\n   * try to reconnect\n   */\n  reConnect = () => {\n    setTimeout(this.connect, this.RECONN_TIMEOUT);\n  };\n\n  /**\n   * creates a new pair if does not exits and returns it\n   * @param {Map} map sub_callbacks or evt_callbacks\n   * @param {string} pattern is the map key\n   *\n   * @returns {array} the value associated with the pattern\n   */\n  getOrCreate = (map, pattern) => {\n    return map.get(pattern) || map.set(pattern, []).get(pattern);\n  };\n\n  /**\n   * push callback to the map\n   * @param {Map} sub_callbacks or evt_callbacks\n   * @param {string} pattern is the map key\n   * @param {function} callback function to execute\n   */\n  pushCallback = (map, pattern, callback) => {\n    this.getOrCreate(map, pattern).push(callback);\n\n    return this;\n  };\n\n  /**\n   * add subscriber callback\n   * @param {function} callback function to execute\n   * @param {string} pattern pattern to subscribe to\n   */\n  addSubscriberCallback = (callback, pattern) => {\n    if (typeof callback !== \"function\") return this;\n\n    return this.pushCallback(this.sub_callbacks, pattern, callback);\n  };\n\n  /**\n   * add event callback\n   * @param {strin} command command to send; event to subscribe\n   * @param {function} callback function to execute\n   * @param {string} pattern pattern to subscribe to\n   */\n  addEventCallback = (command, callback, pattern) => {\n    if (typeof callback !== \"function\") return this;\n\n    const _sufix = pattern ? `/${pattern}` : \"\";\n    const _pattern = `${command}${_sufix}`;\n\n    return this.pushCallback(this.evt_callbacks, _pattern, callback);\n  };\n\n  /**\n   * sends a message to the server\n   * @param {any} message to send to the server\n   */\n  send = (message, retry = 0) => {\n    try {\n      // do not keep trying to send the message after 3 times\n      if (retry >= this.RETRIES) throw new Error(\"Timeout sending message\");\n      // stringify the message before sending it\n      // try to resend if the connection is not yet open\n      this.getState() !== WebSocket.OPEN\n        ? setTimeout(\n            this.websocket.send,\n            this.RESEND_TIMEOUT,\n            message,\n            retry + 1\n          )\n        : this.websocket.send(JSON.stringify(message));\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  /**\n   * execute callbacks subscribed to events or patterns\n   * @param {string} pattern pattern or event\n   * @param {bool} is_command when true callback only executes once\n   * @param {any} message data to pass to the callback\n   */\n  dispatch = (pattern, is_command = true, message) => {\n    const _map = is_command ? this.evt_callbacks : this.sub_callbacks;\n    const _callbacks = _map.get(pattern) || [];\n\n    _callbacks.forEach(cb => {\n      setTimeout(cb, 0, message);\n    });\n\n    if (is_command) _map.delete(pattern);\n  };\n\n  /**\n   * format the message to send to the server\n   * @param {string} event event to send to the server\n   * @param {string} pattern pattern to send to the server\n   */\n  fmtMessage = (event, pattern) => ({ event, pattern });\n\n  /**\n   * triggered when the socket opens\n   */\n  onOpen = evt => {\n    // send current subscriptions to the server\n    this.reSubscribe();\n    this.dispatch(\"onopen\");\n  };\n\n  /**\n   * triggered when the socket closes\n   */\n  onClose = evt => {\n    this.dispatch(\"onclose\");\n\n    // reconnect if the connection was not closed on purpose\n    if (evt.code !== this.NORMAL_CLOSE_EVT) {\n      this.reConnect();\n    }\n  };\n\n  /**\n   * triggered when the socket raises an error\n   */\n  onError = evt => {\n    this.dispatch(\"onerror\");\n  };\n\n  /**\n   * triggered whit authentication error\n   */\n  onAuthError = () => {\n    // reconnect on authentication error\n    this.reConnect();\n  };\n\n  /**\n   * triggered when the socket receives a message\n   */\n  onMessage = msg => {\n    try {\n      const data = JSON.parse(msg.data);\n      if (data.error) throw new Error(data.error);\n\n      const { event } = data;\n      const is_command = Object.values(this.commands).includes(event);\n      const { LIST, EXECUTE } = this.commands;\n\n      const rcv_patterns = [LIST, EXECUTE].includes(event)\n        ? [event]\n        : data.patterns;\n\n      rcv_patterns.forEach(pattern => {\n        const _prefix = is_command ? `${event}/` : \"\";\n        const _pattern = `${_prefix}${JSON.stringify(pattern)}`;\n\n        this.dispatch(_pattern, is_command, data);\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  /**\n   * subscribe to a redis pattern\n   * @param {string} pattern pattern to subscribe to\n   * @param {function} callback function to execute on changes\n   * @param {function} evt_callback function to execute on the subscription event\n   *\n   */\n  subscribe = (pattern, callback, evt_callback) => {\n    const { SUBSCRIBE } = this.commands;\n    const message = this.fmtMessage(SUBSCRIBE, pattern);\n    const _pattern = JSON.stringify(pattern);\n\n    this.initSocket()\n      .addSubscriberCallback(callback, _pattern)\n      .addEventCallback(SUBSCRIBE, evt_callback, _pattern)\n      .send(message);\n  };\n\n  /**\n   * send current subscriptions to the server\n   */\n  reSubscribe = () => {\n    const { SUBSCRIBE } = this.commands;\n\n    Array.from(this.sub_callbacks.keys()).forEach(key => {\n      const message = this.fmtMessage(SUBSCRIBE, JSON.parse(key));\n      this.send(message);\n    });\n  };\n\n  /**\n   * unsubscribe from changes related to the pattern\n   * @param {string} pattern pattern to unsubscribe\n   * @param {function} callback function to execute on event unsubscribe\n   *\n   */\n  unsubscribe = (pattern, callback) => {\n    const { UNSUBSCRIBE } = this.commands;\n    const message = this.fmtMessage(UNSUBSCRIBE, pattern);\n    const _pattern = JSON.stringify(pattern);\n\n    this.initSocket()\n      .addEventCallback(UNSUBSCRIBE, callback, _pattern)\n      .send(message);\n  };\n\n  /**\n   * get the list of the current pattern subscriptions\n   * @param {function} evt_callback function to execute on event\n   */\n  list = evt_callback => {\n    const { LIST } = this.commands;\n    const message = this.fmtMessage(LIST);\n\n    this.initSocket().addEventCallback(LIST, evt_callback).send(message);\n  };\n\n  /**\n   * execute - executes a remote procedure call\n   * @param {string} remote_callback name of the remote callback to execute\n   * @param {object} data data to send to the remote callback\n   * @param {function} evt_callback function to execute on event\n   */\n  execute = (remote_callback, data, evt_callback) => {\n    const { EXECUTE } = this.commands;\n    const message = { event: EXECUTE, callback: remote_callback, ...data };\n\n    this.initSocket().addEventCallback(EXECUTE, evt_callback).send(message);\n  };\n\n  /**\n   * subscribe to events onopen, onclose, onerror\n   * @param {string} event name of the event to subscribe\n   * @param {function} callback function to execute on event\n   */\n  onEvent = (event, callback) => {\n    this.initSocket().addEventCallback(event, callback);\n  };\n\n  /**\n   * close the socket connection\n   */\n  close = () => {\n    this.websocket.close();\n    this.websocket = null;\n  };\n\n  /**\n   * the following code should be moved to a separate class\n   * added to support current applications\n   * TODO. review and move\n   */\n\n  checkTest = (pattern, data, is_pattern, one_shot) => {\n    return new Promise((resolve, reject) => {\n      this.dispatch(pattern, data, is_pattern, one_shot);\n      if (true) {\n        resolve(\"DONE\");\n      }\n    });\n  };\n\n  /* Get value from key in Var, scope fleet or global */\n  getVar = (key, callback = undefined, scope = \"global\") => {\n    if (![\"global\", \"fleet\"].includes(scope)) {\n      throw \"Only fleet and global scopes available.\";\n    }\n    if (scope === \"fleet\") {\n      // key format: robot_name@key_name\n      if (key.split(\"@\").length < 2) {\n        throw \"Wrong key format (robot_name@key_name)\";\n      }\n    }\n    const url = this.REST_API + \"database/\" + scope + \"/\" + key + \"/\";\n\n    checkLogin().then(res => {\n      fetch(url)\n        .then(response => response.json())\n\n        .then(data => {\n          if (callback) {\n            callback(data);\n          } else {\n            //NOTHING\n          }\n        });\n    });\n  };\n\n  /* Set value from key in Var, scope fleet or global */\n  setVar = (key, value, callback = undefined, scope = \"global\") => {\n    if (![\"global\", \"fleet\"].includes(scope)) {\n      throw \"Only fleet and global scopes available.\";\n    }\n    if (scope === \"fleet\") {\n      // key format: robot_name@key_name\n      const values = key.split(\"@\");\n      if (key.split(\"@\").length < 2) {\n        throw \"Wrong key format (robot_name@key_name)\";\n      }\n    }\n    const data = { key: key, scope: scope, value: value };\n    const url = this.REST_API + \"database/\";\n\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"POST\",\n        body: JSON.stringify(data),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          callback(res);\n        }\n      });\n    });\n  };\n\n  /**\n   * GET value from url\n   * @param url String\n   * @param callback function\n   * @memberof Database\n   */\n  get = (url, callback = undefined) => {\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, e);\n            });\n        }\n      });\n    });\n  };\n\n  /**\n   * Set value from key in Scope\n   * @param scope String\n   * @param name String - Instance Name\n   * @param key String - Key to override\n   * @param value Obj\n   * @param callback function\n   * @memberof Database\n   */\n  post = (scope, name, key, value, callback = undefined) => {\n    let url = this.REST_API + scope + \"/\" + name + \"/\";\n    if (name === undefined) {\n      url = this.REST_API + scope + \"/\";\n    }\n\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"POST\",\n        body: JSON.stringify({ key: key, data: value }),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, e);\n            });\n        }\n      });\n    });\n  };\n\n  upload = (packageName, key, value, callback = undefined) => {\n    const url = `${this.REST_API}upload/${packageName}/`;\n    const formData = new FormData();\n    formData.append(\"name\", key);\n    formData.append(`data`, value);\n    fetch(url, {\n      method: \"POST\",\n      body: formData,\n      headers: {\n        Authorization: `Bearer ${getToken()}`\n      }\n    })\n      .then(res => res.json())\n      .then(callback);\n  };\n\n  /**\n   * Update key\n   * @param scope String\n   * @param name String - Instance Name\n   * @param value Obj\n   * @param callback function\n   * @memberof Database\n   */\n  put = (scope, name, value, callback = undefined) => {\n    let url = this.REST_API + scope + \"/\" + name + \"/\";\n\n    if (name === undefined) {\n      url = this.REST_API + scope + \"/\";\n    }\n\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"PUT\",\n        body: JSON.stringify(value),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, res);\n\n              if (process.env.NODE_ENV === \"development\") {\n                alert(\n                  \"Development Mode \\n\" +\n                    \"Status: \" +\n                    res.status +\n                    \"\\n\" +\n                    \"Error: \" +\n                    res.statusText\n                );\n              }\n            });\n        }\n      });\n    });\n  };\n\n  /**\n   * Set value from key in Scope\n   * @param scope String\n   * @param name String - Instance Name\n   * @param key String - Key to override\n   * @param value Obj\n   * @param callback function\n   * @memberof Database\n   */\n  delete = (scope, name, callback = undefined, data = {}) => {\n    let url = this.REST_API + scope + \"/\" + name + \"/\";\n    if (name === undefined) {\n      url = this.REST_API + scope + \"/\";\n      return;\n    }\n\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      fetch(url, {\n        method: \"DELETE\",\n        body: JSON.stringify(data),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, res);\n\n              if (process.env.NODE_ENV === \"development\") {\n                alert(\n                  \"Development Mode \\n\" +\n                    \"Status: \" +\n                    res.status +\n                    \"\\n\" +\n                    \"Error: \" +\n                    res.statusText\n                );\n              }\n            });\n        }\n      });\n    });\n  };\n\n  /**\n   * Set value from key in Scope\n   * @param cloudFunction String - callback name\n   * @param func String - Function in the callback. default \"\"\n   * @param args Object - Args {key:value}... key is the param in the function\n   * @param callback func - Callback to parse the response\n   * @memberof Database\n   */\n  cloudFunction = (cloudFunction, func = \"\", args, callback = undefined) => {\n    checkLogin().then(res => {\n      if (!res) {\n        throw new AuthException(\"login error\");\n      }\n\n      const url = this.REST_API + \"function/\" + cloudFunction + \"/\";\n      fetch(url, {\n        method: \"POST\",\n        body: JSON.stringify({ func: func, args: args }),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res.json().then(data => callback(data));\n        }\n      });\n    });\n  };\n\n  /**\n   * Set tabs in a currentUser\n   * @param scope String\n   * @param name String - Instance Name\n   * @param key String - Key to override\n   * @param value Obj\n   * @param callback function\n   * @memberof Database\n   */\n  postTabs = (name, value, callback = undefined) => {\n    let scope = \"User\";\n    let url = this.REST_API + scope + \"/\" + name + \"/\";\n    if (name === undefined) {\n      url = this.REST_API + scope + \"/\";\n      return;\n    }\n    let newValue = value.map(obj => {\n      return { componentName: obj.componentName, name: obj.name };\n    });\n    const key_workspace = {\n      Workspace: \"*\"\n    };\n\n    checkLogin().then(res => {\n      fetch(url, {\n        method: \"POST\",\n        body: JSON.stringify({ key: key_workspace, data: newValue }),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getToken()}`\n        }\n      }).then(res => {\n        if (callback) {\n          res\n            .json()\n            .then(data => {\n              callback(data, res);\n            })\n            .catch(e => {\n              callback(undefined, res);\n\n              if (process.env.NODE_ENV === \"development\") {\n                alert(\n                  \"Development Mode \\n\" +\n                    \"Status: \" +\n                    res.status +\n                    \"\\n\" +\n                    \"Error: \" +\n                    res.statusText\n                );\n              }\n            });\n        }\n      });\n    });\n  };\n}\n\nexport default WSSub;\n","import WSSub from \"./WSSub\";\n/**\n * A Database singleton\n */\nconst MasterDB = new WSSub();\nexport default MasterDB;\n","import icons from \"../../resources/fonts/movai.woff\";\n\nconst Style = `\n@font-face {\n  font-family: 'mov.ai';\n  src: url(${icons}) format(\"woff\");\n  font-weight: normal;\n  font-style: normal;\n  font-display: block;\n}\n\n[class^=\"icon-\"], [class*=\" icon-\"] {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: 'mov.ai' !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.icon-AddGlobal:before {\n  content: \"\\\\e900\";\n}\n.icon-out:before {\n  content: \"\\\\e901\";\n}\n.icon-in:before {\n  content: \"\\\\e902\";\n}\n.icon-account_circle:before {\n  content: \"\\\\e903\";\n}\n.icon-data_setting:before {\n  content: \"\\\\e904\";\n}\n.icon-supervisor_account:before {\n  content: \"\\\\e905\";\n}\n.icon-add_box:before {\n  content: \"\\\\e906\";\n}\n.icon-time .path1:before {\n  content: \"\\\\e907\";\n  color: rgb(0, 178, 188);\n}\n.icon-time .path2:before {\n  content: \"\\\\e908\";\n  margin-left: -1em;\n  color: rgb(250, 250, 250);\n}\n.icon-carts .path1:before {\n  content: \"\\\\e909\";\n  color: rgb(0, 178, 188);\n}\n.icon-carts .path2:before {\n  content: \"\\\\e90a\";\n  margin-left: -1em;\n  color: rgb(250, 250, 250);\n}\n.icon-tree_24px:before {\n  content: \"\\\\e90b\";\n}\n.icon-expand_more_24px:before {\n  content: \"\\\\e90c\";\n}\n.icon-expand_less_24px:before {\n  content: \"\\\\e90d\";\n}\n.icon-chevron_right_24px:before {\n  content: \"\\\\e90e\";\n}\n.icon-chevron_left_24px:before {\n  content: \"\\\\e90f\";\n}\n.icon-Statistics:before {\n  content: \"\\\\e910\";\n}\n.icon-Scenes:before {\n  content: \"\\\\e911\";\n}\n.icon-Sad:before {\n  content: \"\\\\e912\";\n}\n.icon-Normal:before {\n  content: \"\\\\e913\";\n}\n.icon-Nodes:before {\n  content: \"\\\\e914\";\n}\n.icon-Layouts:before {\n  content: \"\\\\e915\";\n}\n.icon-Happy:before {\n  content: \"\\\\e916\";\n}\n.icon-Flows:before {\n  content: \"\\\\e917\";\n}\n.icon-Filters:before {\n  content: \"\\\\e918\";\n}\n.icon-Empty:before {\n  content: \"\\\\e919\";\n}\n.icon-Callbacks:before {\n  content: \"\\\\e91a\";\n}\n.icon-Annotations:before {\n  content: \"\\\\e91b\";\n}\n.icon-create_new_folder_24px:before {\n  content: \"\\\\e91c\";\n}\n.icon-widgets_24px:before {\n  content: \"\\\\e91d\";\n}\n.icon-log_24px:before {\n  content: \"\\\\e91e\";\n}\n.icon-outlined_hidden:before {\n  content: \"\\\\e91f\";\n}\n.icon-outlined:before {\n  content: \"\\\\e920\";\n}\n.icon-repeat:before {\n  content: \"\\\\e921\";\n  color: #2090b7;\n}\n.icon-edit:before {\n  content: \"\\\\e922\";\n  color: #2091b7;\n}\n.icon-download:before {\n  content: \"\\\\e923\";\n  color: #2091b7;\n}\n.icon-details_24px:before {\n  content: \"\\\\e924\";\n}\n.icon-delete:before {\n  content: \"\\\\e925\";\n  color: #2091b7;\n}\n.icon-check_circle_24px-copy:before {\n  content: \"\\\\e926\";\n}\n.icon-add:before {\n  content: \"\\\\e927\";\n  color: #2091b7;\n}\n.icon-drag_indicator-24px-3:before {\n  content: \"\\\\e928\";\n}\n`;\nexport default Style;\n","export default \"data:font/woff;base64,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\"","export default class UndoManager {\n  constructor(size = 50) {\n    this.size = size;\n    this.undoStack = new Queue(size);\n    this.redoStack = new Queue(size);\n  }\n\n  doIt(undoAbleAction) {\n    undoAbleAction.doAction();\n    this.undoStack.push(undoAbleAction);\n    this.redoStack = new Queue(this.size);\n  }\n\n  addIt(undoAbleAction) {\n    this.undoStack.push(undoAbleAction);\n    this.redoStack = new Queue(this.size);\n  }\n\n  undo() {\n    const undoAbleAction = this.undoStack.pop();\n    if (undoAbleAction) {\n      undoAbleAction.undoAction();\n      this.redoStack.push(undoAbleAction);\n    }\n  }\n\n  redo() {\n    const undoAbleAction = this.redoStack.pop();\n    if (undoAbleAction) {\n      undoAbleAction.doAction();\n      this.undoStack.push(undoAbleAction);\n    }\n  }\n\n  static actionBuilder() {\n    return new UndoAbleActionBuilder();\n  }\n}\n\nclass UndoAbleActionBuilder {\n  constructor() {\n    this._doAction = null;\n    this._undoAction = null;\n  }\n\n  doAction(lambda) {\n    this._doAction = lambda;\n    return this;\n  }\n\n  undoAction(lambda) {\n    this._undoAction = lambda;\n    return this;\n  }\n\n  build() {\n    if ([this._undoAction, this._undoAction].some(x => x == null))\n      throw \"Forgot to set doAction or undoAction\";\n    return { doAction: this._doAction, undoAction: this._undoAction };\n  }\n}\n\nclass Queue {\n  constructor(size = 50) {\n    this.size = size;\n    this.queue = [];\n  }\n\n  push(el) {\n    if (this.queue.length === this.size) {\n      this.queue.shift();\n    }\n    this.queue.push(el);\n  }\n\n  pop() {\n    return this.queue.pop();\n  }\n}\n","/**\n * Clipboard singleton\n */\nexport default class Clipboard {\n  constructor() {\n    if (Clipboard.instance) return Clipboard.instance;\n    Clipboard.instance = this;\n    this._data = {};\n    this.copyKey = Math.random();\n  }\n\n  /**\n   *  get clipboard data\n   */\n  get data() {\n    return this._data;\n  }\n\n  /**\n   *\n   * @param {string} key base key to clear\n   */\n  static clear(key) {\n    const inst = new Clipboard();\n    if (key) delete inst._data[key];\n  }\n\n  /**\n   *\n   * @param {string} key base key to read\n   */\n  static read(key) {\n    // consider return a maybe\n    const inst = new Clipboard();\n    return key ? inst.data[key] : inst.data;\n  }\n\n  /**\n   *\n   * @param {string} key base key to write\n   * @param {any} value object, primitive, etc, to write\n   */\n  static write(key, value) {\n    return (new Clipboard()._data[key] = value);\n  }\n\n  /**\n   * Copies value\n   * @param {*} value\n   */\n  static copy(value) {\n    Clipboard.write(new Clipboard().copyKey, value);\n  }\n\n  /**\n   * Retrieve copied object\n   */\n  static paste() {\n    // consider making deep copy\n    return Clipboard.read(new Clipboard().copyKey);\n  }\n}\n","import Authentication from \"../Authentication/Authentication\";\n\nclass User {\n  constructor() {\n    this.baseUrl = `${window.location.origin}/api/v1/User`;\n    this.tokenData = Authentication.getTokenData();\n    this.data = null;\n    this.timestamp = null;\n    this.TIMEOUT = 3000; // milisec\n  }\n\n  getData = () => {\n    const headers = {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${Authentication.getToken()}`\n    };\n    const { name } = this.tokenData.message;\n    const url = `${this.baseUrl}/${name}/`;\n\n    return new Promise((resolve, reject) => {\n      const currTime = new Date().getTime();\n\n      // send cached value\n      if (currTime - this.timestamp <= this.TIMEOUT && this.data) {\n        return resolve({ response: this.data });\n      }\n\n      this.timestamp = currTime;\n\n      fetch(url, { headers })\n        .then(response => {\n          // request error\n          if (!response.ok) {\n            reject({ error: response.statusText });\n          }\n\n          // parse response\n          response\n            .json()\n            .then(data => {\n              this.data = data;\n              resolve({ response: data });\n            })\n            .catch(error => {\n              this.data = null;\n              reject({ error });\n            });\n        })\n        .catch(error => {\n          // error while parsing request\n          this.data = null;\n          reject({ error });\n        });\n    });\n  };\n\n  isSuperUser = async () => {\n    const data = await this.getData();\n    return data?.response?.Superuser || false;\n  };\n}\n\nexport default User;\n","import { Subject, BehaviorSubject } from \"rxjs\";\nimport lodash from \"lodash\";\n\nimport Utils from \"../../Utils/Utils\";\n//import RestApi from \"../../RestApi\";\n\nexport default class BaseModel {\n  constructor(manager, model, database, patterns) {\n    this.db_states = Object.freeze({ error: -1, loading: 0, ready: 1 });\n    this.db = database;\n    this.model = model;\n    this.manager = manager;\n\n    this._subject = new Subject();\n    this._cache = new Map();\n    this._subject_state = new BehaviorSubject(0);\n    this._db_state = this.db_states.loading;\n\n    this.patterns = this._validatePatterns(patterns);\n    this.nr_patterns = this.patterns.length;\n\n    //this.api = new RestApi(this.model);\n\n    this._initialize();\n  }\n\n  _initialize = () => {\n    this.patterns.forEach(pattern => this._subscribe(pattern));\n\n    return this;\n  };\n\n  _subscribe = pattern => {\n    this.db.subscribe(\n      pattern,\n      data => this._onDataChange(data),\n      data => this._onDataLoad(data)\n    );\n  };\n\n  _validatePatterns = patterns => {\n    const default_pattern = { Scope: this.model, Name: \"*\" };\n    const _patterns = patterns ? patterns : default_pattern;\n    return Array.isArray(_patterns) ? _patterns : [_patterns];\n  };\n\n  get db_state() {\n    return this._db_state;\n  }\n\n  set db_state(value) {\n    if (value !== this._db_state) {\n      this._db_state = value;\n      if (value !== this.db_states.ready) {\n        this._subject_state.next(value);\n      } else {\n        this._subject_state.complete();\n      }\n    }\n  }\n\n  get = id => {\n    return this._cache.get(id);\n  };\n\n  getAll = () => {\n    return this._cache.values();\n  };\n\n  _get_or_create = key => {\n    return (\n      this.get(key) ||\n      this.add(key, {\n        name: key,\n        obj: {},\n        id: key\n      }).get(key)\n    );\n  };\n\n  add = (key, data) => {\n    return this._cache.set(key, data);\n  };\n\n  remove = key => {\n    this._cache.delete(key);\n  };\n\n  destroy = () => {\n    this.patterns.forEach(pattern => this.db.unsubscribe(pattern));\n  };\n\n  /**\n   * removes empty objects, returning changed object\n   */\n  removeEmpty = (obj, path) => {\n    let new_obj = null;\n\n    if (lodash.isEmpty(lodash.get(obj, path, {}))) {\n      // remove empty\n      new_obj = lodash.omit(obj, path);\n\n      const up_path = path.split(\".\");\n      // check up level is empty\n      if (up_path.length > 1) {\n        new_obj = this.removeEmpty(new_obj, up_path.slice(0, -1).join(\".\"));\n      }\n    }\n\n    return new_obj || obj;\n  };\n\n  /**\n   *    Events\n   */\n\n  _onDataChange = data => {\n    const obj = lodash.get(data, `key.${this.model}`, {});\n\n    Object.keys(obj).forEach(key => {\n      const entry = this._get_or_create(key);\n\n      if (data.event === \"del\") {\n        // deleting an entry\n        const path = Object.keys(Utils.flattenObject(obj[key]))[0];\n\n        entry.obj = this.removeEmpty(lodash.omit(entry.obj, path), path);\n\n        // completly remove object\n        if (lodash.isEmpty(entry.obj)) {\n          this.remove(key);\n        }\n      } else {\n        // updating an entry\n        lodash.merge(entry.obj, obj[key]);\n      }\n\n      this._subject.next({ data: entry, event: data.event });\n    });\n  };\n\n  _onDataLoad = data => {\n    const obj = lodash.get(data, `value.${this.model}`, {});\n\n    Object.keys(obj).forEach(key => {\n      /*this.add(key, {\n        obj: obj[key],\n        id: key\n      });*/\n      const entry = this._get_or_create(key);\n      lodash.merge(entry.obj, obj[key]);\n    });\n\n    if (--this.nr_patterns <= 0) {\n      this.db_state = this.db_states.ready;\n    }\n  };\n\n  onReady = callback => {\n    if (this.db_state !== this.db_states.ready) {\n      this._subject_state.subscribe(\n        () => {},\n        () => {},\n        () => callback()\n      );\n    } else {\n      callback();\n    }\n  };\n\n  onUpdate = callback => {\n    this._subject.subscribe(callback);\n  };\n}\n","import lodash from \"lodash\";\nimport { BehaviorSubject } from \"rxjs\";\n\nexport default class DataManagerBase {\n  constructor() {\n    this.models = {};\n    this.db_states = Object.freeze({ error: -1, loading: 0, ready: 1 });\n    this.isReady = 0;\n    this._subject_state = new BehaviorSubject(0);\n  }\n\n  _initialize = () => {\n    if (lodash.isEmpty(this.models)) {\n      throw new Error(\"No models added\");\n    }\n\n    Object.keys(this.models).forEach(key => {\n      const prop = key.charAt(0).toLowerCase() + key.slice(1);\n\n      Object.defineProperty(this, prop, {\n        get: () => {\n          return this.models[key];\n        }\n      });\n    });\n    return this._subscribeModelsReady();\n  };\n\n  _subscribeModelsReady = () => {\n    Object.keys(this.models).forEach(key => {\n      this.models[key].onReady(() => this._setModelReady(key));\n    });\n    return this;\n  };\n\n  _setModelReady = model => {\n    this.isReady += 1;\n    if (this.isReady === Object.keys(this.models).length) {\n      this._subject_state.complete();\n    }\n  };\n\n  get db_state() {\n    return this.isReady === Object.keys(this.models).length\n      ? this.db_states.ready\n      : this.db_states.loading;\n  }\n\n  onUpdate = (subscribeTo, callback) => {\n    return subscribeTo.onUpdate(callback);\n  };\n\n  onReady = callback => {\n    if (this.db_state !== this.db_states.ready) {\n      this._subject_state.subscribe(\n        () => {},\n        () => {},\n        () => callback()\n      );\n    } else {\n      callback();\n    }\n  };\n}\n","const RestBase = {};\n\n/**\n * Encodes the values of an object\n * @param {Object} data Object to encode\n */\nRestBase.encodeURI = data => {\n  const output = {};\n  for (const [key, value] of Object.entries(data)) {\n    output[key] = encodeURIComponent(value);\n  }\n  return output;\n};\n\n/**\n * Get composed url\n * @param {String} path Relative path\n */\nRestBase.getUrl = ({ path, search = {} }) => {\n  const host = `${window.location.hostname}:${window.location.port}`;\n\n  const params = new URLSearchParams(RestBase.encodeURI(search));\n\n  return `${\n    window.location.protocol\n  }//${host}/api/${path}?${params.toString()}`;\n};\n\n/**\n * Execute request\n * @param {String} path Relative path\n * @param {String} method Request method\n * @param {Object} body Request payload\n */\nRestBase._request = ({\n  path,\n  method = \"GET\",\n  body = {},\n  search,\n  customHeaders = {}\n}) => {\n  const headers = customHeaders;\n  const url = RestBase.getUrl({ path, search });\n  const skipBody = [\"HEAD\", \"GET\"];\n\n  const payload = {\n    method,\n    headers\n  };\n  console.log(\"payload\", payload);\n\n  if (!skipBody.includes(method)) payload.body = JSON.stringify(body);\n\n  return fetch(url, payload).then(response => {\n    if (!response.ok) {\n      return Promise.reject(response);\n    }\n    return response.json();\n  });\n};\n\n/**\n * Execute GET request\n * @param {String} path Relative path\n * @param {String} search Search parameters\n */\n\nRestBase.get = ({ path, search, customHeaders = {} }) => {\n  return RestBase._request({ path, search, customHeaders });\n};\n\n/**\n * Execute POST request\n * @param {String} path Relative path\n * @param {Object} body Request payload\n */\nRestBase.post = ({ path, body, customHeaders = {} }) => {\n  const method = \"POST\";\n\n  return RestBase._request({ path, method, body, customHeaders });\n};\n\n/**\n * Execute PUT request\n * @param {String} path Relative path\n * @param {Object} body Request payload\n */\nRestBase.put = ({ path, body, customHeaders = {} }) => {\n  const method = \"PUT\";\n\n  return RestBase._request({ path, method, body, customHeaders });\n};\n\n/**\n * Execute DELETE request\n * @param {String} path Relative path\n */\nRestBase.delete = ({ path, body, customHeaders = {} }) => {\n  const method = \"DELETE\";\n\n  return RestBase._request({ path, method, body, customHeaders });\n};\n\n/**\n * Upload file to a specific Package\n * @param {String} packageName Package name\n * @param {String} key Key to insert in the package\n * @param {String} value Value of the key\n */\nRestBase.upload = ({ packageName, key, value, customHeaders = {} }) => {\n  const path = `upload/${packageName}/`;\n  const body = new FormData();\n  body.append(\"name\", key);\n  body.append(\"data\", value);\n\n  return RestBase.post({ path, body, customHeaders });\n};\n\n/**\n * Execute remote procedure call\n * @param {String} cbName Callback name\n * @param {String} func Function in the callback\n * @param {Object} args Args to pass to the function\n */\nRestBase.cloudFunction = ({ cbName, func = \"\", args, customHeaders = {} }) => {\n  const path = `function/${cbName}/`;\n  const body = { func, args };\n\n  return RestBase.post({ path, body, customHeaders }).then(response =>\n    response.json()\n  );\n};\n\nRestBase.validScope = scope => [\"global\", \"fleet\"].includes(scope);\nRestBase.validKey = key => key.split(\"@\") >= 2;\nRestBase.validateVar = (key, scope) => {\n  const validators = [\n    {\n      fn: scope => RestBase.validScope(scope),\n      error: \"Invalid scope\"\n    },\n    {\n      fn: key => RestBase.validKey(key),\n      error: \"Key format should be <robot name>@<key name>\"\n    }\n  ];\n\n  validators.forEach(obj => {\n    if (!obj.fn()) {\n      throw new Error(obj.error);\n    }\n  });\n};\n\nRestBase.getVar = ({ key, scope = \"global\", customHeaders = {} }) => {\n  RestBase.validateVar(key, scope);\n\n  const path = `v1/database/${scope}/${key}/`;\n\n  return RestBase.get({ path, customHeaders }).then(response =>\n    response.json()\n  );\n};\n\nRestBase.setVar = ({ key, value, scope = \"global\", customHeaders = {} }) => {\n  RestBase.validateVar(key, scope);\n\n  const path = `v1/database/`;\n  const body = { key, scope, value };\n\n  return RestBase.post({ path, body, customHeaders }).then(response =>\n    response.json()\n  );\n};\n\nexport default RestBase;\n","import Authentication from \"../Authentication/Authentication\";\nconst { checkLogin, AuthException, getToken } = Authentication;\n\nconst withAuth = (obj, props = {}) => {\n  const handler = {\n    __checkLogin: (target, prop) => {\n      return args =>\n        checkLogin().then(res => {\n          // check login error\n          if (!res) {\n            throw new AuthException(\"Login error\");\n          }\n\n          // inject authorization headers\n          const customHeaders = {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${getToken()}`\n          };\n\n          // return the original call with custom headers and original arguments\n          return Reflect.get(target, prop)({ customHeaders, ...args });\n        });\n    },\n\n    get: function (target, prop) {\n      return this.__checkLogin(target, prop);\n    }\n  };\n\n  return new Proxy(Object.assign(obj, props), handler);\n};\n\nexport default withAuth;\n","import RestBase from \"./RestBase\";\nimport withAuth from \"./WithAuth\";\n\nconst Rest = withAuth(RestBase);\n\nexport default Rest;\n","import Rest from \"../Rest/Rest\";\n\nconst Snapshot = {};\n\n/**\n * Create a snapshot from a specific document\n * @param {Object} target Object with the following params\n * @param {Object} source Object with the following params\n *  @param {String} workspace Target workspace where the document will be\n *  @param {String} type Type of the document\n *  @param {String} name Source name of the document\n *  @param {String} version Source version of the snapshot\n */\nSnapshot.create = ({ target, source }) => {\n  const body = {\n    src: `${source.workspace}/${source.type}/${source.name}/${source.version}/`\n  };\n  const path = `v2/db/${target.workspace || source.workspace}/${target.type}/${\n    target.name\n  }/${target.version}/`;\n\n  return Rest.post({ path, body });\n};\n\n/**\n * Delete a specific snapshot\n */\nSnapshot.delete = () => {\n  throw new Error(\"Not implemented\");\n};\n\n/**\n * Get the data of a snapshot\n * @param {String} workspace Workspace to read from\n * @param {String} type Type of the document\n * @param {String} name Name of the snapshot\n * @param {String} version Version of the snapshot\n */\nSnapshot.read = ({ workspace, type, name, version }) => {\n  const path = `v2/db/${workspace}/${type}/${name}/${version}/`;\n\n  return Rest.get({ path });\n};\n\n/**\n * Create document in the global workspace\n * @param {Object} target Object with the following params\n * @param {Object} source Object with the following params\n *  @param {String} workspace Target workspace where the document will be\n *  @param {String} type Type of the document\n *  @param {String} name Source name of the document\n *  @param {String} version Source version of the snapshot\n */\nSnapshot.restore = ({ target, source }) => {\n  target.workspace = \"global\";\n\n  return Snapshot.create({ target, source });\n};\n\n/**\n * Get all the snapshots of a document\n * @param {String} workspace Workspace to read from\n * @param {String} type Type of the document\n * @param {String} name Name of the document\n */\nSnapshot.getAll = ({ workspace, type, name }) => {\n  const path = `v2/db/${workspace}/${type}/${name}/`;\n\n  return Rest.get({ path });\n};\n\nexport default Snapshot;\n","import BaseModel from \"./Models/BaseModel\";\nimport MasterDB from \"./MasterDB\";\nimport Rest from \"../Rest/Rest\";\nimport Snapshot from \"./Snapshot\";\n\nclass Document {\n  constructor({\n    type,\n    name,\n    workspace = \"global\",\n    version,\n    uri,\n    apiVersion = \"v1\"\n  }) {\n    this._init(type, name, workspace, version, uri, apiVersion);\n  }\n\n  /** Initialization */\n  _init = (type, name, workspace, version, uri, apiVersion) => {\n    this._parseArgs(workspace, type, name, version, uri);\n    this.subscriber = undefined;\n    this.database = MasterDB;\n    this.data = {};\n    this.apiVersion = apiVersion; //v1 || v2\n  };\n\n  /** Parse instance args */\n  _parseArgs = (workspace, type, name, version, uri) => {\n    const [_workspace, _type, _name, _version] = (uri || \"\").split(\"/\");\n\n    this.workspace = _workspace || workspace;\n    this.type = _type || type;\n    this.name = _name || name;\n    this.version = _version || version;\n  };\n\n  /** Document properties */\n\n  /**\n   * Get document read only status\n   */\n  get readOnly() {\n    return Boolean(this.version);\n  }\n\n  /** Document handlers */\n\n  /**\n   * Get document data\n   */\n  read = () => {\n    const { workspace, type, name, version, apiVersion } = this;\n\n    const paths = {\n      v1: `v1/${type}/${name}/`,\n      v2: `v2/db/${workspace}/${type}/${name}/${version}/`\n    };\n    const path = paths[apiVersion];\n\n    return Rest.get({ path }).then(data => {\n      this.data = data;\n      return data;\n    });\n  };\n\n  /**\n   * Update the document using PUT request\n   * @param {Object} body Request payload\n   */\n  update = body => {\n    const { type, name, apiVersion } = this;\n\n    const paths = {\n      v1: `v1/${type}/${name}/`,\n      v2: `v2/db/${workspace}/${type}/${name}/${version}/`\n    };\n    const path = paths[apiVersion];\n\n    return Rest.put({ path, body });\n  };\n\n  /** Subscribers */\n\n  /**\n   * Subscribe to document changes (notifications only available in the global workspace)\n   * @param {Function} callback Callback to execute when the document is updated\n   */\n  subscribe = callback => {\n    this.resubscribe(callback);\n  };\n\n  /**\n   * Resubscribe to document changes (notifications only available in the global workspace)\n   * @param {Function} callback Callback to execute when the document is updated\n   */\n  resubscribe = callback => {\n    if (this.readOnly) return;\n\n    this.unsubscribe();\n\n    this.subscriber = new BaseModel({}, this.type, this.database, [\n      { Scope: this.type, Name: this.name }\n    ]);\n\n    this.subscriber.onUpdate(() => {\n      this.data = this.subscriber.get(this.name)?.obj || {};\n      callback(this.data);\n    });\n  };\n\n  /**\n   * Unsubscribe from document changes\n   */\n  unsubscribe = () => {\n    if (this.subscriber) this.subscriber.destroy();\n    this.subscriber = null;\n  };\n\n  /** Snapshot handlers */\n\n  /**\n   *\n   * @param {String} trgWorkspace Workspace where to create the snapshot\n   * @param {String} version Snapshot version\n   */\n  createSnapshot = ({ trgWorkspace, version }) => {\n    const { workspace, type, name } = this;\n\n    return Snapshot.create({\n      trgWorkspace,\n      srcWorkspace: workspace,\n      type,\n      name,\n      version\n    });\n  };\n\n  /**\n   * Get list of snapshots for the current document in the current workspace\n   */\n  getSnapShots = () => {\n    const { workspace, type, name } = this;\n\n    return Snapshot.getAll({\n      workspace,\n      type,\n      name\n    });\n  };\n\n  /** Static handlers */\n\n  /**\n   *\n   * @param {String} type Type of the document\n   * @param {String} name Name of the document\n   * @param {String} workspace Workspace of the document\n   * @param {String} version Version of the document\n   */\n  static create({ type, name, apiVersion = \"v1\", workspace }) {\n    const paths = {\n      v1: `v1/${type}/`,\n      v2: `v2/db/${workspace}/${type}/${name}/`\n    };\n    const path = paths[apiVersion];\n\n    const bodies = {\n      v1: { data: { Label: name } },\n      v2: { Label: name }\n    };\n    const body = bodies[apiVersion];\n\n    return Rest.post({ path, body });\n  }\n\n  /**\n   * Delete document or partial deletion of the document\n   * @param {String} type Type of the document\n   * @param {String} name Name of the document\n   * @param {Object} body Data of the document\n   */\n  static delete({ type, name, body, apiVersion = \"v1\", workspace = \"global\" }) {\n    const paths = {\n      v1: `v1/${type}/${name}/`,\n      v2: `v2/db/${workspace}/${type}/${name}/`\n    };\n    const path = paths[apiVersion];\n\n    return Rest.delete({ path, body });\n  }\n\n  /**\n   * Get all existing documents in a workspace\n   * @param {String} workspace workspace to search\n   * @param {String} type filter documents by type\n   */\n  static getAll({ workspace, type }) {\n    const _type = type ? `${type}/` : \"\";\n    const path = `v2/db/${workspace}/${_type}`;\n\n    return Rest.get({ path });\n  }\n}\n\nexport default Document;\n","import Rest from \"../Rest/Rest\";\n\nconst Workspace = {};\n\nWorkspace.create = () => {\n  throw new Error(\"Not implemented\");\n};\nWorkspace.delete = () => {\n  throw new Error(\"Not implemented\");\n};\n\n/**\n * Get a list of all locally available workspaces\n */\nWorkspace.getAll = () => {\n  const path = \"v2/db/\";\n\n  return Rest.get({ path });\n};\n\nexport default Workspace;\n"],"sourceRoot":""}