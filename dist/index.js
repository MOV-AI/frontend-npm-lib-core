!function(A,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Movai=e():A.Movai=e()}(window,(function(){return function(A){var e={};function n(t){if(e[t])return e[t].exports;var o=e[t]={i:t,l:!1,exports:{}};return A[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=A,n.c=e,n.d=function(A,e,t){n.o(A,e)||Object.defineProperty(A,e,{enumerable:!0,get:t})},n.r=function(A){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(A,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(A,"__esModule",{value:!0})},n.t=function(A,e){if(1&e&&(A=n(A)),8&e)return A;if(4&e&&"object"==typeof A&&A&&A.__esModule)return A;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:A}),2&e&&"string"!=typeof A)for(var o in A)n.d(t,o,function(e){return A[e]}.bind(null,o));return t},n.n=function(A){var e=A&&A.__esModule?function(){return A.default}:function(){return A};return n.d(e,"a",e),e},n.o=function(A,e){return Object.prototype.hasOwnProperty.call(A,e)},n.p="",n(n.s=10)}([function(A,e){A.exports=require("@babel/runtime/helpers/esm/defineProperty")},function(A,e){A.exports=require("@babel/runtime/helpers/esm/classCallCheck")},function(A,e){A.exports=require("@babel/runtime/helpers/esm/createClass")},function(A,e){A.exports=require("lodash")},function(A,e){A.exports=require("@babel/runtime/regenerator")},function(A,e){A.exports=require("@babel/runtime/helpers/esm/asyncToGenerator")},function(A,e){A.exports=require("rxjs")},function(A,e){A.exports=require("jwt-decode")},function(A,e){A.exports=require("monet")},function(A,e){A.exports=require("@babel/runtime/helpers/esm/typeof")},function(A,e,n){"use strict";n.r(e),n.d(e,"Authentication",(function(){return u})),n.d(e,"Utils",(function(){return f})),n.d(e,"Database",(function(){return T})),n.d(e,"MasterDB",(function(){return Y})),n.d(e,"AuthWebSocket",(function(){return p})),n.d(e,"Style",(function(){return R})),n.d(e,"UndoManager",(function(){return N})),n.d(e,"Clipboard",(function(){return x})),n.d(e,"WSSub",(function(){return j})),n.d(e,"User",(function(){return G})),n.d(e,"BaseModel",(function(){return z})),n.d(e,"DataManagerBase",(function(){return V}));var t=n(4),o=n.n(t),i=n(5),c=n.n(i),r=n(7),s=n.n(r),a={AuthException:function(A){this.message=A,this.name="AuthException"},getToken:function(){var A=window.localStorage.getItem("movai.token");return A||!1},getRefreshToken:function(){var A=window.localStorage.getItem("movai.refreshToken");return A||!1},getTokenData:function(){try{var A=a.getToken();return{message:s()(A).message,auth_token:!1,refresh_token:a.getRefreshToken(),error:!1,access_token:A}}catch(A){return{message:{},error:!0}}}};a.login=function(){var A=c()(o.a.mark((function A(e,n,t){var i,c,r,s;return o.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return window.localStorage.removeItem("movai.token"),window.localStorage.removeItem("movai.refreshToken"),window.localStorage.removeItem("movai.tokenRemember"),window.sessionStorage.removeItem("movai.session"),(i={})["Content-Type"]="application/json","/token-auth/",A.prev=7,A.next=10,fetch("/token-auth/",{method:"POST",headers:i,body:JSON.stringify({username:e,password:n,remember:t})});case 10:return c=A.sent,r=c.status,A.next=14,c.json();case 14:return s=A.sent,200===r&&(window.localStorage.setItem("movai.token",s.access_token),window.localStorage.setItem("movai.refreshToken",s.refresh_token),window.localStorage.setItem("movai.tokenRemember","undefined"!=t&&t),window.sessionStorage.setItem("movai.session",!0)),A.abrupt("return",s);case 19:throw A.prev=19,A.t0=A.catch(7),A.t0;case 22:case"end":return A.stop()}}),A,null,[[7,19]])})));return function(e,n,t){return A.apply(this,arguments)}}(),a.logout=function(){window.localStorage.removeItem("movai.token"),window.localStorage.removeItem("movai.refreshToken"),window.localStorage.removeItem("movai.tokenRemember"),window.sessionStorage.removeItem("movai.session")},a.checkLogin=c()(o.a.mark((function A(){var e,n,t,i,c,r,u,h,B;return o.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:if(e=window.localStorage.getItem("movai.token"),n=window.localStorage.getItem("movai.refreshToken"),t=window.localStorage.getItem("movai.tokenRemember"),i=window.sessionStorage.getItem("movai.session"),null!==e&&null!==n){A.next=6;break}return A.abrupt("return",!1);case 6:c=null,A.prev=7,c=s()(e),A.next=14;break;case 11:return A.prev=11,A.t0=A.catch(7),A.abrupt("return",!1);case 14:if(!(c.exp>(new Date).getTime()/1e3)){A.next=16;break}return A.abrupt("return",!0);case 16:if("false"!=t||null!==i){A.next=19;break}return a.logout(),A.abrupt("return",!1);case 19:if(!n){A.next=41;break}if(A.prev=20,!(s()(n).exp<(new Date).getTime()/1e3)){A.next=24;break}throw"refresh token has expired";case 24:return"/token-refresh/",r={"Content-Type":"application/json"},A.next=28,fetch("/token-refresh/",{method:"POST",headers:r,body:JSON.stringify({token:n})});case 28:return u=A.sent,h=u.status,A.next=32,u.json();case 32:if(B=A.sent,200!==h){A.next=37;break}return window.localStorage.setItem("movai.token",B.access_token),window.localStorage.setItem("movai.refreshToken",B.refresh_token),A.abrupt("return",!0);case 37:A.next=41;break;case 39:A.prev=39,A.t1=A.catch(20);case 41:return A.abrupt("return",!1);case 42:case"end":return A.stop()}}),A,null,[[7,11],[20,39]])})));var u=a,h=n(9),B=n.n(h),l=n(8),g={ofNull:function(A){return l.Maybe.fromNull(A)},getter:function(A){return function(e){return e[A]}},dot:function(A){return function(e){return function(n){return A(e(n))}}},maybeGet:function(A){return g.dot(g.ofNull)(g.getter(A))},range:function(A,e){for(var n=l.Maybe.fromNull(e).map((function(n){return{i:A,e:e}})).orSome({i:0,e:A}),t=n.i,o=n.e,i=[],c=t;c<o;c++)i.push(c);return i},randomInt:function(A,e){return Math.floor(g.random(A,e))},random:function(A,e){var n=l.Maybe.fromNull(e).map((function(n){return{init:A,end:e}})).orSome({init:0,end:A}),t=n.init;return t+(n.end-t)*Math.random()},normalizeStr:function(A){return A.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()},groupBy:function(A,e){var n={};return A.forEach((function(A){var t=e(A);n[t]||(n[t]=[]),n[t].push(A)})),n},capitalize:function(A){return"string"!=typeof A?"":A.charAt(0).toUpperCase()+A.slice(1)},mod:function(A,e){return(A%e+e)%e},flattenObject:function(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(A).reduce((function(n,t){var o=e.length?e+".":"";return"object"===B()(A[t])?Object.assign(n,flattenObject(A[t],o+t)):n[o+t]=A[t],n}),{})}},f=g,E=n(1),d=n.n(E),w=n(0),Q=n.n(w),b=n(2),I=n.n(b),v=u.checkLogin,y=u.getToken,M=u.AuthException,p=function(){function A(e){var n=this,t=e.url,o=void 0===t?this.wsUrl:t,i=e.onOpen,c=void 0===i?null:i,r=e.onClose,s=void 0===r?null:r,a=e.onError,u=void 0===a?null:a,h=e.onMessage,B=void 0===h?null:h,l=e.connectionHandler,g=void 0===l?null:l;d()(this,A),Q()(this,"_onOpen",(function(A){console.log("Socket Open: ",A)})),Q()(this,"_onClose",(function(A){console.log("Socket Close: ",A),n.connected=!1,n.socket=null,n.timerId&&clearTimeout(n.timerId),n.timerId=setTimeout((function(){n.createSocket()}),5e3)})),Q()(this,"_onError",(function(A){n.connected=!1,console.log("Socket Error: ",A)})),Q()(this,"_onMessage",(function(A){console.log("Socket Message: ",A)})),Q()(this,"_connectionHandler",(function(A){console.log("Invalid Token, no handler specified! ",A)})),this.onOpen=null===c?this._onOpen:c,this.onClose=null===s?this._onClose:s,this.onError=null===u?this._onError:u,this.onMessage=null===B?this._onMessage:B,this.connectionHandler=null===g?this._connectionHandler:g,this.wsUrl=o,this.socket=!1,this.timerId=!1,this.connected=!1}return I()(A,[{key:"createSocket",value:function(){var A=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!1;v().then((function(t){if(!t)throw new M("login error");e=!1!==e?e:A.wsUrl;var o=new URL(e),i=new URLSearchParams(o.search.slice(1));i.set("token",y()),o.search=i,(n=new WebSocket(o.toString())).onopen=A.onOpen,n.onerror=A.onError,n.onclose=A.onClose,n.onmessage=A.onMessage,A.socket=n})).catch((function(e){"AuthException"===e.name&&A.connectionHandler(!1)}))}},{key:"send",value:function(A){var e=this;v().then((function(n){if(!n)throw new M("login error");e.socket.send(A)})).catch((function(n){switch(n.name){case"AuthException":e.connectionHandler(!1);break;case"InvalidStateError":var t=e,o=void 0;o=setInterval((function(){1===t.socket.readyState&&(clearInterval(o),t.socket.send(A))}),400,o)}}))}},{key:"close",value:function(){this.socket&&(this.socket.close(),clearTimeout(this.timerId),this.connected=!1)}}]),A}(),m=u.getToken,k=u.AuthException,S=u.checkLogin,T=function A(){var e=this;d()(this,A),Q()(this,"connect",(function(){e.websocket=new p({url:e.WS_API,onOpen:e.onOpen,onClose:e.onClose,onError:e.onError,onMessage:e.onMessage,connectionHandler:null}),e.websocket.createSocket()})),Q()(this,"onOpen",(function(A){e.dispatch("onopen",void 0)})),Q()(this,"onClose",(function(A){e.dispatch("onclose",void 0),1e3!==A.code&&window.setTimeout(e.connect(),e.timeout)})),Q()(this,"onMessage",(function(A){var n;try{n=JSON.parse(A.data)}catch(A){return void console.error(A)}if(n.error)console.error(n.error);else{var t=n.patterns,o=!0,i=!1;["list","unsubscribe","subscribe"].includes(n.event)&&(t=t.map((function(A){return"unsubscribe"===n.event&&delete e.callbacks[JSON.stringify(A)],n.event+"/"+JSON.stringify(A)})),"list"===n.event&&(t=["list"]),o=!1,i=!0),t.map((function(A){e.dispatch(A,n,o,i)}))}})),Q()(this,"checkTest",(function(A,n,t,o){return new Promise((function(i,c){e.dispatch(A,n,t,o),i("DONE")}))})),Q()(this,"onError",(function(A){e.dispatch("onerror",void 0)})),Q()(this,"onEvent",(function(A){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;e.evt_callbacks[A]=e.evt_callbacks[A]||[],e.evt_callbacks[A].push(n)})),Q()(this,"close",(function(){return e.websocket.close()})),Q()(this,"subscribe",(function(A){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o={event:"subscribe",pattern:A},i=JSON.stringify(A);e.callbacks[i]=e.callbacks[i]||[],e.callbacks[i].push(n),t&&(e.evt_callbacks["subscribe/"+i]=e.evt_callbacks["subscribe"+i]||[],e.evt_callbacks["subscribe/"+i].push(t)),e._send(o)})),Q()(this,"unsubscribe",(function(A){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;console.log("Unsubscribe called "+JSON.stringify(A));var t={event:"unsubscribe",pattern:A},o=JSON.stringify(A);n&&(e.evt_callbacks["unsubscribe/"+o]=e.evt_callbacks["unsubscribe/"+o]||[],e.evt_callbacks["unsubscribe/"+o].push(n)),e._send(t)})),Q()(this,"list",(function(){var A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n={event:"list"};e.evt_callbacks.list=e.evt_callbacks.list||[],e.evt_callbacks.list.push(A),e._send(n)})),Q()(this,"_send",(function(A){e.websocket.send(JSON.stringify(A))})),Q()(this,"dispatch",(function(A,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=void 0,c=A;if(!0===t?(c=JSON.stringify(A),i=e.callbacks[c]):i=e.evt_callbacks[c],void 0!==i){for(var r=0;r<i.length;r++)"function"==typeof i[r]&&i[r](n);i&&!0===o&&(i=[])}})),Q()(this,"getVar",(function(A){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"global";if(!["global","fleet"].includes(t))throw"Only fleet and global scopes available.";if("fleet"===t&&A.split("@").length<2)throw"Wrong key format (robot_name@key_name)";var o=e.REST_API+"database/"+t+"/"+A+"/";S().then((function(A){fetch(o).then((function(A){return A.json()})).then((function(A){n&&n(A)}))}))})),Q()(this,"setVar",(function(A,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"global";if(!["global","fleet"].includes(o))throw"Only fleet and global scopes available.";if("fleet"===o){A.split("@");if(A.split("@").length<2)throw"Wrong key format (robot_name@key_name)"}var i={key:A,scope:o,value:n},c=e.REST_API+"database/";S().then((function(A){if(!A)throw new k("login error");fetch(c,{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m())}}).then((function(A){t&&t(A)}))}))})),Q()(this,"get",(function(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;S().then((function(n){if(!n)throw new k("login error");fetch(A,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m())}}).then((function(A){e&&A.json().then((function(n){e(n,A)})).catch((function(A){e(void 0,A)}))}))}))})),Q()(this,"post",(function(A,n,t,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,c=e.REST_API+A+"/"+n+"/";void 0===n&&(c=e.REST_API+A+"/"),S().then((function(A){if(!A)throw new k("login error");fetch(c,{method:"POST",body:JSON.stringify({key:t,data:o}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m())}}).then((function(A){i&&A.json().then((function(e){i(e,A)})).catch((function(A){i(void 0,A)}))}))}))})),Q()(this,"upload",(function(A,n,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i="".concat(e.REST_API,"upload/").concat(A,"/"),c=new FormData;c.append("name",n),c.append("data",t),fetch(i,{method:"POST",body:c}).then((function(A){return A.json()})).then(o)})),Q()(this,"put",(function(A,n,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=e.REST_API+A+"/"+n+"/";console.log("database put",i),void 0===n&&(i=e.REST_API+A+"/"),S().then((function(A){if(!A)throw new k("login error");fetch(i,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m())}}).then((function(A){o&&A.json().then((function(e){o(e,A)})).catch((function(e){o(void 0,A)}))}))}))})),Q()(this,"delete",(function(A,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.REST_API+A+"/"+n+"/";void 0!==n?S().then((function(A){if(!A)throw new k("login error");fetch(i,{method:"DELETE",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m())}}).then((function(A){t&&A.json().then((function(e){t(e,A)})).catch((function(e){t(void 0,A)}))}))})):i=e.REST_API+A+"/"})),Q()(this,"cloudFunction",(function(A){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;S().then((function(i){if(!i)throw new k("login error");var c=e.REST_API+"function/"+A+"/";fetch(c,{method:"POST",body:JSON.stringify({func:n,args:t}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m())}}).then((function(A){o&&A.json().then((function(A){return o(A)}))}))}))})),Q()(this,"postTabs",(function(A,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o="User",i=e.REST_API+o+"/"+A+"/";if(void 0!==A){var c=n.map((function(A){return{componentName:A.componentName,name:A.name}})),r={Workspace:"*"};S().then((function(A){fetch(i,{method:"POST",body:JSON.stringify({key:r,data:c}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m())}}).then((function(A){t&&A.json().then((function(e){t(e,A)})).catch((function(e){t(void 0,A)}))}))}))}else i=e.REST_API+o+"/"})),this.host="".concat(window.location.hostname,":").concat(window.location.port);var n="https:"===window.location.protocol;this.WS_API="".concat(n?"wss":"ws","://").concat(this.host,"/ws/subscriber"),this.REST_API="".concat(window.location.protocol,"//").concat(this.host,"/api/v1/"),this.callbacks={},this.evt_callbacks={},this.timeout=3e3,this.websocket=void 0,this.connect()};function C(A,e){var n=Object.keys(A);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(A);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),n.push.apply(n,t)}return n}var U=u.getToken,D=u.AuthException,F=u.checkLogin,j=function A(){var e=this;d()(this,A),Q()(this,"getState",(function(){var A,n;return(null===(A=e.websocket)||void 0===A||null===(n=A.socket)||void 0===n?void 0:n.readyState)||WebSocket.CLOSED})),Q()(this,"initSocket",(function(){if(e.websocket)return e;var A=e.url,n=e.onOpen,t=e.onClose,o=e.onError,i=e.onMessage,c=e.onAuthError;return e.websocket=new p({url:A,onOpen:n,onClose:t,onError:o,onMessage:i,connectionHandler:c}),e.connect(),e})),Q()(this,"connect",(function(){return e.websocket.createSocket(),e})),Q()(this,"reConnect",(function(){setTimeout(e.connect,e.RECONN_TIMEOUT)})),Q()(this,"getOrCreate",(function(A,e){return A.get(e)||A.set(e,[]).get(e)})),Q()(this,"pushCallback",(function(A,n,t){return e.getOrCreate(A,n).push(t),e})),Q()(this,"addSubscriberCallback",(function(A,n){return"function"!=typeof A?e:e.pushCallback(e.sub_callbacks,n,A)})),Q()(this,"addEventCallback",(function(A,n,t){if("function"!=typeof n)return e;var o=t?"/".concat(t):"",i="".concat(A).concat(o);return e.pushCallback(e.evt_callbacks,i,n)})),Q()(this,"send",(function(A){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{if(n>=e.RETRIES)throw new Error("Timeout sending message");e.getState()!==WebSocket.OPEN?setTimeout(e.websocket.send,e.RESEND_TIMEOUT,A,n+1):e.websocket.send(JSON.stringify(A))}catch(A){console.error(A)}})),Q()(this,"dispatch",(function(A){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=arguments.length>2?arguments[2]:void 0,o=n?e.evt_callbacks:e.sub_callbacks,i=o.get(A)||[];i.forEach((function(A){setTimeout(A,0,t)})),n&&o.delete(A)})),Q()(this,"fmtMessage",(function(A,e){return{event:A,pattern:e}})),Q()(this,"onOpen",(function(A){e.reSubscribe(),e.dispatch("onopen")})),Q()(this,"onClose",(function(A){e.dispatch("onclose"),A.code!==e.NORMAL_CLOSE_EVT&&e.reConnect()})),Q()(this,"onError",(function(A){e.dispatch("onerror")})),Q()(this,"onAuthError",(function(){e.reConnect()})),Q()(this,"onMessage",(function(A){try{var n=JSON.parse(A.data);if(n.error)throw new Error(n.error);var t=n.event,o=Object.values(e.commands).includes(t),i=e.commands;([i.LIST,i.EXECUTE].includes(t)?[t]:n.patterns).forEach((function(A){var i=o?"".concat(t,"/"):"",c="".concat(i).concat(JSON.stringify(A));e.dispatch(c,o,n)}))}catch(A){console.error(A)}})),Q()(this,"subscribe",(function(A,n,t){var o=e.commands.SUBSCRIBE,i=e.fmtMessage(o,A),c=JSON.stringify(A);e.initSocket().addSubscriberCallback(n,c).addEventCallback(o,t,c).send(i)})),Q()(this,"reSubscribe",(function(){var A=e.commands.SUBSCRIBE;Array.from(e.sub_callbacks.keys()).forEach((function(n){var t=e.fmtMessage(A,JSON.parse(n));e.send(t)}))})),Q()(this,"unsubscribe",(function(A,n){var t=e.commands.UNSUBSCRIBE,o=e.fmtMessage(t,A),i=JSON.stringify(A);e.initSocket().addEventCallback(t,n,i).send(o)})),Q()(this,"list",(function(A){var n=e.commands.LIST,t=e.fmtMessage(n);e.initSocket().addEventCallback(n,A).send(t)})),Q()(this,"execute",(function(A,n,t){var o=e.commands.EXECUTE,i=function(A){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Q()(A,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(n,e))}))}return A}({event:o,callback:A},n);e.initSocket().addEventCallback(o,t).send(i)})),Q()(this,"onEvent",(function(A,n){e.initSocket().addEventCallback(A,n)})),Q()(this,"close",(function(){e.websocket.close(),e.websocket=null})),Q()(this,"checkTest",(function(A,n,t,o){return new Promise((function(i,c){e.dispatch(A,n,t,o),i("DONE")}))})),Q()(this,"getVar",(function(A){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"global";if(!["global","fleet"].includes(t))throw"Only fleet and global scopes available.";if("fleet"===t&&A.split("@").length<2)throw"Wrong key format (robot_name@key_name)";var o=e.REST_API+"database/"+t+"/"+A+"/";F().then((function(A){fetch(o).then((function(A){return A.json()})).then((function(A){n&&n(A)}))}))})),Q()(this,"setVar",(function(A,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"global";if(!["global","fleet"].includes(o))throw"Only fleet and global scopes available.";if("fleet"===o){A.split("@");if(A.split("@").length<2)throw"Wrong key format (robot_name@key_name)"}var i={key:A,scope:o,value:n},c=e.REST_API+"database/";F().then((function(A){if(!A)throw new D("login error");fetch(c,{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(A){t&&t(A)}))}))})),Q()(this,"get",(function(A){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;F().then((function(n){if(!n)throw new D("login error");fetch(A,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(A){e&&A.json().then((function(n){e(n,A)})).catch((function(A){e(void 0,A)}))}))}))})),Q()(this,"post",(function(A,n,t,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,c=e.REST_API+A+"/"+n+"/";void 0===n&&(c=e.REST_API+A+"/"),F().then((function(A){if(!A)throw new D("login error");fetch(c,{method:"POST",body:JSON.stringify({key:t,data:o}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(A){i&&A.json().then((function(e){i(e,A)})).catch((function(A){i(void 0,A)}))}))}))})),Q()(this,"upload",(function(A,n,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i="".concat(e.REST_API,"upload/").concat(A,"/"),c=new FormData;c.append("name",n),c.append("data",t),fetch(i,{method:"POST",body:c}).then((function(A){return A.json()})).then(o)})),Q()(this,"put",(function(A,n,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=e.REST_API+A+"/"+n+"/";void 0===n&&(i=e.REST_API+A+"/"),F().then((function(A){if(!A)throw new D("login error");fetch(i,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(A){o&&A.json().then((function(e){o(e,A)})).catch((function(e){o(void 0,A)}))}))}))})),Q()(this,"delete",(function(A,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.REST_API+A+"/"+n+"/";void 0!==n?F().then((function(A){if(!A)throw new D("login error");fetch(i,{method:"DELETE",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(A){t&&A.json().then((function(e){t(e,A)})).catch((function(e){t(void 0,A)}))}))})):i=e.REST_API+A+"/"})),Q()(this,"cloudFunction",(function(A){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;F().then((function(i){if(!i)throw new D("login error");var c=e.REST_API+"function/"+A+"/";fetch(c,{method:"POST",body:JSON.stringify({func:n,args:t}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(A){o&&A.json().then((function(A){return o(A)}))}))}))})),Q()(this,"postTabs",(function(A,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o="User",i=e.REST_API+o+"/"+A+"/";if(void 0!==A){var c=n.map((function(A){return{componentName:A.componentName,name:A.name}})),r={Workspace:"*"};F().then((function(A){fetch(i,{method:"POST",body:JSON.stringify({key:r,data:c}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(A){t&&A.json().then((function(e){t(e,A)})).catch((function(e){t(void 0,A)}))}))}))}else i=e.REST_API+o+"/"})),this.host="".concat(window.location.hostname,":").concat(window.location.port);var n="https:"===window.location.protocol;this.url="".concat(n?"wss":"ws","://").concat(this.host,"/ws/subscriber"),this.REST_API="".concat(window.location.protocol,"//").concat(this.host,"/api/v1/"),this.RECONN_TIMEOUT=3e3,this.RESEND_TIMEOUT=1e3,this.RETRIES=3,this.NORMAL_CLOSE_EVT=1e3,this.commands={SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",LIST:"list",EXECUTE:"execute"},this.websocket=null,this.sub_callbacks=new Map,this.evt_callbacks=new Map},Y=new j,R="\n@font-face {\n  font-family: 'mov.ai';\n  src: url(".concat("data:font/woff;base64,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",') format("woff");\n  font-weight: normal;\n  font-style: normal;\n  font-display: block;\n}\n\n[class^="icon-"], [class*=" icon-"] {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: \'mov.ai\' !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.icon-AddGlobal:before {\n  content: "\\e900";\n}\n.icon-out:before {\n  content: "\\e901";\n}\n.icon-in:before {\n  content: "\\e902";\n}\n.icon-account_circle:before {\n  content: "\\e903";\n}\n.icon-data_setting:before {\n  content: "\\e904";\n}\n.icon-supervisor_account:before {\n  content: "\\e905";\n}\n.icon-add_box:before {\n  content: "\\e906";\n}\n.icon-time .path1:before {\n  content: "\\e907";\n  color: rgb(0, 178, 188);\n}\n.icon-time .path2:before {\n  content: "\\e908";\n  margin-left: -1em;\n  color: rgb(250, 250, 250);\n}\n.icon-carts .path1:before {\n  content: "\\e909";\n  color: rgb(0, 178, 188);\n}\n.icon-carts .path2:before {\n  content: "\\e90a";\n  margin-left: -1em;\n  color: rgb(250, 250, 250);\n}\n.icon-tree_24px:before {\n  content: "\\e90b";\n}\n.icon-expand_more_24px:before {\n  content: "\\e90c";\n}\n.icon-expand_less_24px:before {\n  content: "\\e90d";\n}\n.icon-chevron_right_24px:before {\n  content: "\\e90e";\n}\n.icon-chevron_left_24px:before {\n  content: "\\e90f";\n}\n.icon-Statistics:before {\n  content: "\\e910";\n}\n.icon-Scenes:before {\n  content: "\\e911";\n}\n.icon-Sad:before {\n  content: "\\e912";\n}\n.icon-Normal:before {\n  content: "\\e913";\n}\n.icon-Nodes:before {\n  content: "\\e914";\n}\n.icon-Layouts:before {\n  content: "\\e915";\n}\n.icon-Happy:before {\n  content: "\\e916";\n}\n.icon-Flows:before {\n  content: "\\e917";\n}\n.icon-Filters:before {\n  content: "\\e918";\n}\n.icon-Empty:before {\n  content: "\\e919";\n}\n.icon-Callbacks:before {\n  content: "\\e91a";\n}\n.icon-Annotations:before {\n  content: "\\e91b";\n}\n.icon-create_new_folder_24px:before {\n  content: "\\e91c";\n}\n.icon-widgets_24px:before {\n  content: "\\e91d";\n}\n.icon-log_24px:before {\n  content: "\\e91e";\n}\n.icon-outlined_hidden:before {\n  content: "\\e91f";\n}\n.icon-outlined:before {\n  content: "\\e920";\n}\n.icon-repeat:before {\n  content: "\\e921";\n  color: #2090b7;\n}\n.icon-edit:before {\n  content: "\\e922";\n  color: #2091b7;\n}\n.icon-download:before {\n  content: "\\e923";\n  color: #2091b7;\n}\n.icon-details_24px:before {\n  content: "\\e924";\n}\n.icon-delete:before {\n  content: "\\e925";\n  color: #2091b7;\n}\n.icon-check_circle_24px-copy:before {\n  content: "\\e926";\n}\n.icon-add:before {\n  content: "\\e927";\n  color: #2091b7;\n}\n.icon-drag_indicator-24px-3:before {\n  content: "\\e928";\n}\n'),N=function(){function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;d()(this,A),this.size=e,this.undoStack=new P(e),this.redoStack=new P(e)}return I()(A,[{key:"doIt",value:function(A){A.doAction(),this.undoStack.push(A),this.redoStack=new P(this.size)}},{key:"addIt",value:function(A){this.undoStack.push(A),this.redoStack=new P(this.size)}},{key:"undo",value:function(){var A=this.undoStack.pop();A&&(A.undoAction(),this.redoStack.push(A))}},{key:"redo",value:function(){var A=this.redoStack.pop();A&&(A.doAction(),this.undoStack.push(A))}}],[{key:"actionBuilder",value:function(){return new O}}]),A}(),O=function(){function A(){d()(this,A),this._doAction=null,this._undoAction=null}return I()(A,[{key:"doAction",value:function(A){return this._doAction=A,this}},{key:"undoAction",value:function(A){return this._undoAction=A,this}},{key:"build",value:function(){if([this._undoAction,this._undoAction].some((function(A){return null==A})))throw"Forgot to set doAction or undoAction";return{doAction:this._doAction,undoAction:this._undoAction}}}]),A}(),P=function(){function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;d()(this,A),this.size=e,this.queue=[]}return I()(A,[{key:"push",value:function(A){this.queue.length===this.size&&this.queue.shift(),this.queue.push(A)}},{key:"pop",value:function(){return this.queue.pop()}}]),A}(),x=function(){function A(){if(d()(this,A),A.instance)return A.instance;A.instance=this,this._data={},this.copyKey=Math.random()}return I()(A,[{key:"data",get:function(){return this._data}}],[{key:"clear",value:function(e){var n=new A;e&&delete n._data[e]}},{key:"read",value:function(e){var n=new A;return e?n.data[e]:n.data}},{key:"write",value:function(e,n){return(new A)._data[e]=n}},{key:"copy",value:function(e){A.write((new A).copyKey,e)}},{key:"paste",value:function(){return A.read((new A).copyKey)}}]),A}(),G=function A(){var e=this;d()(this,A),Q()(this,"getData",(function(){var A={"Content-Type":"application/json",Authorization:"Bearer ".concat(u.getToken())},n=e.tokenData.message.name,t="".concat(e.baseUrl,"/").concat(n,"/");return new Promise((function(n,o){var i=(new Date).getTime();if(i-e.timestamp<=e.TIMEOUT&&e.data)return n({response:e.data});e.timestamp=i,fetch(t,{headers:A}).then((function(A){A.ok||o({error:A.statusText}),A.json().then((function(A){e.data=A,n({response:A})})).catch((function(A){e.data=null,o({error:A})}))})).catch((function(A){e.data=null,o({error:A})}))}))})),Q()(this,"isSuperUser",c()(o.a.mark((function A(){var n,t;return o.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,e.getData();case 2:return t=A.sent,A.abrupt("return",(null==t||null===(n=t.response)||void 0===n?void 0:n.Superuser)||!1);case 4:case"end":return A.stop()}}),A)})))),this.baseUrl="".concat(window.location.origin,"/api/v1/User"),this.tokenData=u.getTokenData(),this.data=null,this.timestamp=null,this.TIMEOUT=3e3},J=n(6),_=n(3),H=n.n(_),z=function(){function A(e,n,t,o){var i=this;d()(this,A),Q()(this,"_initialize",(function(){return i.patterns.forEach((function(A){return i._subscribe(A)})),i})),Q()(this,"_subscribe",(function(A){i.db.subscribe(A,(function(A){return i._onDataChange(A)}),(function(A){return i._onDataLoad(A)}))})),Q()(this,"_validatePatterns",(function(A){var e={Scope:i.model,Name:"*"},n=A||e;return Array.isArray(n)?n:[n]})),Q()(this,"get",(function(A){return i._cache.get(A)})),Q()(this,"getAll",(function(){return i._cache.values()})),Q()(this,"_get_or_create",(function(A){return i.get(A)||i.add(A,{name:A,obj:{},id:A}).get(A)})),Q()(this,"add",(function(A,e){return i._cache.set(A,e)})),Q()(this,"remove",(function(A){i._cache.delete(A)})),Q()(this,"destroy",(function(){i.patterns.forEach((function(A){return i.db.unsubscribe(A)}))})),Q()(this,"removeEmpty",(function(A,e){var n=null;if(H.a.isEmpty(H.a.get(A,e,{}))){n=H.a.omit(A,e);var t=e.split(".");t.length>1&&(n=i.removeEmpty(n,t.slice(0,-1).join(".")))}return n||A})),Q()(this,"_onDataChange",(function(A){var e=H.a.get(A,"key.".concat(i.model),{});Object.keys(e).forEach((function(n){var t=i._get_or_create(n);if("del"===A.event){var o=Object.keys(f.flattenObject(e[n]))[0];t.obj=i.removeEmpty(H.a.omit(t.obj,o),o),H.a.isEmpty(t.obj)&&i.remove(n)}else H.a.merge(t.obj,e[n]);i._subject.next({data:t,event:A.event})}))})),Q()(this,"_onDataLoad",(function(A){var e=H.a.get(A,"value.".concat(i.model),{});Object.keys(e).forEach((function(A){var n=i._get_or_create(A);H.a.merge(n.obj,e[A])})),--i.nr_patterns<=0&&(i.db_state=i.db_states.ready)})),Q()(this,"onReady",(function(A){i.db_state!==i.db_states.ready?i._subject_state.subscribe((function(){}),(function(){}),(function(){return A()})):A()})),Q()(this,"onUpdate",(function(A){i._subject.subscribe(A)})),this.db_states=Object.freeze({error:-1,loading:0,ready:1}),this.db=t,this.model=n,this.manager=e,this._subject=new J.Subject,this._cache=new Map,this._subject_state=new J.BehaviorSubject(0),this._db_state=this.db_states.loading,this.patterns=this._validatePatterns(o),this.nr_patterns=this.patterns.length,this._initialize()}return I()(A,[{key:"db_state",get:function(){return this._db_state},set:function(A){A!==this._db_state&&(this._db_state=A,A!==this.db_states.ready?this._subject_state.next(A):this._subject_state.complete())}}]),A}(),V=function(){function A(){var e=this;d()(this,A),Q()(this,"_initialize",(function(){if(H.a.isEmpty(e.models))throw new Error("No models added");return Object.keys(e.models).forEach((function(A){var n=A.charAt(0).toLowerCase()+A.slice(1);Object.defineProperty(e,n,{get:function(){return e.models[A]}})})),e._subscribeModelsReady()})),Q()(this,"_subscribeModelsReady",(function(){return Object.keys(e.models).forEach((function(A){e.models[A].onReady((function(){return e._setModelReady(A)}))})),e})),Q()(this,"_setModelReady",(function(A){e.isReady+=1,e.isReady===Object.keys(e.models).length&&e._subject_state.complete()})),Q()(this,"onUpdate",(function(A,e){return A.onUpdate(e)})),Q()(this,"onReady",(function(A){e.db_state!==e.db_states.ready?e._subject_state.subscribe((function(){}),(function(){}),(function(){return A()})):A()})),this.models={},this.db_states=Object.freeze({error:-1,loading:0,ready:1}),this.isReady=0,this._subject_state=new J.BehaviorSubject(0)}return I()(A,[{key:"db_state",get:function(){return this.isReady===Object.keys(this.models).length?this.db_states.ready:this.db_states.loading}}]),A}()}])}));
//# sourceMappingURL=index.js.map