!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.Movai=n():e.Movai=n()}(window,(function(){return function(e){var n={};function t(A){if(n[A])return n[A].exports;var o=n[A]={i:A,l:!1,exports:{}};return e[A].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,A){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:A})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var A=Object.create(null);if(t.r(A),Object.defineProperty(A,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(A,o,function(n){return e[n]}.bind(null,o));return A},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=11)}([function(e,n){e.exports=require("@babel/runtime/helpers/esm/defineProperty")},function(e,n){e.exports=require("@babel/runtime/helpers/esm/classCallCheck")},function(e,n){e.exports=require("@babel/runtime/helpers/esm/createClass")},function(e,n){e.exports=require("lodash")},function(e,n){e.exports=require("@babel/runtime/regenerator")},function(e,n){e.exports=require("@babel/runtime/helpers/esm/asyncToGenerator")},function(e,n){e.exports=require("rxjs")},function(e,n){e.exports=require("@babel/runtime/helpers/esm/slicedToArray")},function(e,n){e.exports=require("jwt-decode")},function(e,n){e.exports=require("monet")},function(e,n){e.exports=require("@babel/runtime/helpers/esm/typeof")},function(e,n,t){"use strict";t.r(n),t.d(n,"Authentication",(function(){return u})),t.d(n,"Utils",(function(){return f})),t.d(n,"Database",(function(){return T})),t.d(n,"MasterDB",(function(){return O})),t.d(n,"AuthWebSocket",(function(){return m})),t.d(n,"Style",(function(){return R})),t.d(n,"UndoManager",(function(){return N})),t.d(n,"Clipboard",(function(){return x})),t.d(n,"WSSub",(function(){return j})),t.d(n,"User",(function(){return G})),t.d(n,"BaseModel",(function(){return V})),t.d(n,"DataManagerBase",(function(){return z})),t.d(n,"Document",(function(){return re})),t.d(n,"Workspace",(function(){return ie})),t.d(n,"Snapshot",(function(){return oe})),t.d(n,"Rest",(function(){return te}));var A=t(4),o=t.n(A),r=t(5),c=t.n(r),i=t(8),a=t.n(i),s={AuthException:function(e){this.message=e,this.statusText=e,this.name="AuthException"},getToken:function(){var e=window.localStorage.getItem("movai.token");return e||!1},getRefreshToken:function(){var e=window.localStorage.getItem("movai.refreshToken");return e||!1},getTokenData:function(){try{var e=s.getToken();return{message:a()(e).message,auth_token:!1,refresh_token:s.getRefreshToken(),error:!1,access_token:e}}catch(e){return{message:{},error:!0}}}};s.login=function(){var e=c()(o.a.mark((function e(n,t,A){var r,c,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.localStorage.removeItem("movai.token"),window.localStorage.removeItem("movai.refreshToken"),window.localStorage.removeItem("movai.tokenRemember"),window.sessionStorage.removeItem("movai.session"),(r={})["Content-Type"]="application/json","/token-auth/",e.prev=7,e.next=10,fetch("/token-auth/",{method:"POST",headers:r,body:JSON.stringify({username:n,password:t,remember:A})});case 10:return c=e.sent,i=c.status,e.next=14,c.json();case 14:return a=e.sent,200===i&&(window.localStorage.setItem("movai.token",a.access_token),window.localStorage.setItem("movai.refreshToken",a.refresh_token),window.localStorage.setItem("movai.tokenRemember","undefined"!=A&&A),window.sessionStorage.setItem("movai.session",!0)),e.abrupt("return",a);case 19:throw e.prev=19,e.t0=e.catch(7),e.t0;case 22:case"end":return e.stop()}}),e,null,[[7,19]])})));return function(n,t,A){return e.apply(this,arguments)}}(),s.logout=function(){window.localStorage.removeItem("movai.token"),window.localStorage.removeItem("movai.refreshToken"),window.localStorage.removeItem("movai.tokenRemember"),window.sessionStorage.removeItem("movai.session")},s.checkLogin=c()(o.a.mark((function e(){var n,t,A,r,c,i,u,h,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.localStorage.getItem("movai.token"),t=window.localStorage.getItem("movai.refreshToken"),A=window.localStorage.getItem("movai.tokenRemember"),r=window.sessionStorage.getItem("movai.session"),null!==n&&null!==t){e.next=6;break}return e.abrupt("return",!1);case 6:c=null,e.prev=7,c=a()(n),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(7),e.abrupt("return",!1);case 14:if(!(c.exp>(new Date).getTime()/1e3)){e.next=16;break}return e.abrupt("return",!0);case 16:if("false"!=A||null!==r){e.next=19;break}return s.logout(),e.abrupt("return",!1);case 19:if(!t){e.next=41;break}if(e.prev=20,!(a()(t).exp<(new Date).getTime()/1e3)){e.next=24;break}throw"refresh token has expired";case 24:return"/token-refresh/",i={"Content-Type":"application/json"},e.next=28,fetch("/token-refresh/",{method:"POST",headers:i,body:JSON.stringify({token:t})});case 28:return u=e.sent,h=u.status,e.next=32,u.json();case 32:if(l=e.sent,200!==h){e.next=37;break}return window.localStorage.setItem("movai.token",l.access_token),window.localStorage.setItem("movai.refreshToken",l.refresh_token),e.abrupt("return",!0);case 37:e.next=41;break;case 39:e.prev=39,e.t1=e.catch(20);case 41:return e.abrupt("return",!1);case 42:case"end":return e.stop()}}),e,null,[[7,11],[20,39]])})));var u=s,h=t(10),l=t.n(h),B=t(9),d={ofNull:function(e){return B.Maybe.fromNull(e)},getter:function(e){return function(n){return n[e]}},dot:function(e){return function(n){return function(t){return e(n(t))}}},maybeGet:function(e){return d.dot(d.ofNull)(d.getter(e))},range:function(e,n){for(var t=B.Maybe.fromNull(n).map((function(t){return{i:e,e:n}})).orSome({i:0,e:e}),A=t.i,o=t.e,r=[],c=A;c<o;c++)r.push(c);return r},randomInt:function(e,n){return Math.floor(d.random(e,n))},random:function(e,n){var t=B.Maybe.fromNull(n).map((function(t){return{init:e,end:n}})).orSome({init:0,end:e}),A=t.init;return A+(t.end-A)*Math.random()},normalizeStr:function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()},groupBy:function(e,n){var t={};return e.forEach((function(e){var A=n(e);t[A]||(t[A]=[]),t[A].push(e)})),t},capitalize:function(e){return"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)},mod:function(e,n){return(e%n+n)%n},flattenObject:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(e).reduce((function(t,A){var o=n.length?n+".":"";return"object"===l()(e[A])?Object.assign(t,d.flattenObject(e[A],o+A)):t[o+A]=e[A],t}),{})}},f=d,g=t(1),E=t.n(g),w=t(0),b=t.n(w),v=t(2),p=t.n(v),y=u.checkLogin,Q=u.getToken,I=u.AuthException,m=function(){function e(n){var t=this,A=n.url,o=void 0===A?this.wsUrl:A,r=n.onOpen,c=void 0===r?null:r,i=n.onClose,a=void 0===i?null:i,s=n.onError,u=void 0===s?null:s,h=n.onMessage,l=void 0===h?null:h,B=n.connectionHandler,d=void 0===B?null:B;E()(this,e),b()(this,"_onOpen",(function(e){console.log("Socket Open: ",e)})),b()(this,"_onClose",(function(e){console.log("Socket Close: ",e),t.connected=!1,t.socket=null,t.timerId&&clearTimeout(t.timerId),t.timerId=setTimeout((function(){t.createSocket()}),5e3)})),b()(this,"_onError",(function(e){t.connected=!1,console.log("Socket Error: ",e)})),b()(this,"_onMessage",(function(e){console.log("Socket Message: ",e)})),b()(this,"_connectionHandler",(function(e){console.log("Invalid Token, no handler specified! ",e)})),this.onOpen=null===c?this._onOpen:c,this.onClose=null===a?this._onClose:a,this.onError=null===u?this._onError:u,this.onMessage=null===l?this._onMessage:l,this.connectionHandler=null===d?this._connectionHandler:d,this.wsUrl=o,this.socket=!1,this.timerId=!1,this.connected=!1}return p()(e,[{key:"createSocket",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!1;y().then((function(A){if(!A)throw new I("login error");n=!1!==n?n:e.wsUrl;var o=new URL(n),r=new URLSearchParams(o.search.slice(1));r.set("token",Q()),o.search=r,(t=new WebSocket(o.toString())).onopen=e.onOpen,t.onerror=e.onError,t.onclose=e.onClose,t.onmessage=e.onMessage,e.socket=t})).catch((function(n){"AuthException"===n.name&&e.connectionHandler(!1)}))}},{key:"send",value:function(e){var n=this;y().then((function(t){if(!t)throw new I("login error");n.socket.send(e)})).catch((function(t){switch(t.name){case"AuthException":n.connectionHandler(!1);break;case"InvalidStateError":var A=n,o=void 0;o=setInterval((function(){1===A.socket.readyState&&(clearInterval(o),A.socket.send(e))}),400,o)}}))}},{key:"close",value:function(){this.socket&&(this.socket.close(),clearTimeout(this.timerId),this.connected=!1)}}]),e}(),M=u.getToken,k=u.AuthException,S=u.checkLogin,T=function e(){var n=this;E()(this,e),b()(this,"connect",(function(){n.websocket=new m({url:n.WS_API,onOpen:n.onOpen,onClose:n.onClose,onError:n.onError,onMessage:n.onMessage,connectionHandler:null}),n.websocket.createSocket()})),b()(this,"onOpen",(function(e){n.dispatch("onopen",void 0)})),b()(this,"onClose",(function(e){n.dispatch("onclose",void 0),1e3!==e.code&&window.setTimeout(n.connect(),n.timeout)})),b()(this,"onMessage",(function(e){var t;try{t=JSON.parse(e.data)}catch(e){return void console.error(e)}if(t.error)console.error(t.error);else{var A=t.patterns,o=!0,r=!1;["list","unsubscribe","subscribe"].includes(t.event)&&(A=A.map((function(e){return"unsubscribe"===t.event&&delete n.callbacks[JSON.stringify(e)],t.event+"/"+JSON.stringify(e)})),"list"===t.event&&(A=["list"]),o=!1,r=!0),A.map((function(e){n.dispatch(e,t,o,r)}))}})),b()(this,"checkTest",(function(e,t,A,o){return new Promise((function(r,c){n.dispatch(e,t,A,o),r("DONE")}))})),b()(this,"onError",(function(e){n.dispatch("onerror",void 0)})),b()(this,"onEvent",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;n.evt_callbacks[e]=n.evt_callbacks[e]||[],n.evt_callbacks[e].push(t)})),b()(this,"close",(function(){return n.websocket.close()})),b()(this,"subscribe",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o={event:"subscribe",pattern:e},r=JSON.stringify(e);n.callbacks[r]=n.callbacks[r]||[],n.callbacks[r].push(t),A&&(n.evt_callbacks["subscribe/"+r]=n.evt_callbacks["subscribe"+r]||[],n.evt_callbacks["subscribe/"+r].push(A)),n._send(o)})),b()(this,"unsubscribe",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;console.log("Unsubscribe called "+JSON.stringify(e));var A={event:"unsubscribe",pattern:e},o=JSON.stringify(e);t&&(n.evt_callbacks["unsubscribe/"+o]=n.evt_callbacks["unsubscribe/"+o]||[],n.evt_callbacks["unsubscribe/"+o].push(t)),n._send(A)})),b()(this,"list",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t={event:"list"};n.evt_callbacks.list=n.evt_callbacks.list||[],n.evt_callbacks.list.push(e),n._send(t)})),b()(this,"_send",(function(e){n.websocket.send(JSON.stringify(e))})),b()(this,"dispatch",(function(e,t){var A=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=void 0,c=e;if(!0===A?(c=JSON.stringify(e),r=n.callbacks[c]):r=n.evt_callbacks[c],void 0!==r){for(var i=0;i<r.length;i++)"function"==typeof r[i]&&r[i](t);r&&!0===o&&(r=[])}})),b()(this,"getVar",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"global";if(!["global","fleet"].includes(A))throw"Only fleet and global scopes available.";if("fleet"===A&&e.split("@").length<2)throw"Wrong key format (robot_name@key_name)";var o=n.REST_API+"database/"+A+"/"+e+"/";S().then((function(e){fetch(o).then((function(e){return e.json()})).then((function(e){t&&t(e)}))}))})),b()(this,"setVar",(function(e,t){var A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"global";if(!["global","fleet"].includes(o))throw"Only fleet and global scopes available.";if("fleet"===o){e.split("@");if(e.split("@").length<2)throw"Wrong key format (robot_name@key_name)"}var r={key:e,scope:o,value:t},c=n.REST_API+"database/";S().then((function(e){if(!e)throw new k("login error");fetch(c,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(M())}}).then((function(e){A&&A(e)}))}))})),b()(this,"get",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;S().then((function(t){if(!t)throw new k("login error");fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(M())}}).then((function(e){n&&e.json().then((function(t){n(t,e)})).catch((function(e){n(void 0,e)}))}))}))})),b()(this,"post",(function(e,t,A,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,c=n.REST_API+e+"/"+t+"/";void 0===t&&(c=n.REST_API+e+"/"),S().then((function(e){if(!e)throw new k("login error");fetch(c,{method:"POST",body:JSON.stringify({key:A,data:o}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(M())}}).then((function(e){r&&e.json().then((function(n){r(n,e)})).catch((function(e){r(void 0,e)}))}))}))})),b()(this,"upload",(function(e,t,A){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,r="".concat(n.REST_API,"upload/").concat(e,"/"),c=new FormData;c.append("name",t),c.append("data",A),fetch(r,{method:"POST",body:c}).then((function(e){return e.json()})).then(o)})),b()(this,"put",(function(e,t,A){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,r=n.REST_API+e+"/"+t+"/";console.log("database put",r),void 0===t&&(r=n.REST_API+e+"/"),S().then((function(e){if(!e)throw new k("login error");fetch(r,{method:"PUT",body:JSON.stringify(A),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(M())}}).then((function(e){o&&e.json().then((function(n){o(n,e)})).catch((function(n){o(void 0,e)}))}))}))})),b()(this,"delete",(function(e,t){var A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n.REST_API+e+"/"+t+"/";void 0!==t?S().then((function(e){if(!e)throw new k("login error");fetch(r,{method:"DELETE",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(M())}}).then((function(e){A&&e.json().then((function(n){A(n,e)})).catch((function(n){A(void 0,e)}))}))})):r=n.REST_API+e+"/"})),b()(this,"cloudFunction",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",A=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;S().then((function(r){if(!r)throw new k("login error");var c=n.REST_API+"function/"+e+"/";fetch(c,{method:"POST",body:JSON.stringify({func:t,args:A}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(M())}}).then((function(e){o&&e.json().then((function(e){return o(e)}))}))}))})),b()(this,"postTabs",(function(e,t){var A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o="User",r=n.REST_API+o+"/"+e+"/";if(void 0!==e){var c=t.map((function(e){return{componentName:e.componentName,name:e.name}})),i={Workspace:"*"};S().then((function(e){fetch(r,{method:"POST",body:JSON.stringify({key:i,data:c}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(M())}}).then((function(e){A&&e.json().then((function(n){A(n,e)})).catch((function(n){A(void 0,e)}))}))}))}else r=n.REST_API+o+"/"})),this.host="".concat(window.location.hostname,":").concat(window.location.port);var t="https:"===window.location.protocol;this.WS_API="".concat(t?"wss":"ws","://").concat(this.host,"/ws/subscriber"),this.REST_API="".concat(window.location.protocol,"//").concat(this.host,"/api/v1/"),this.callbacks={},this.evt_callbacks={},this.timeout=3e3,this.websocket=void 0,this.connect()};function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(e);n&&(A=A.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,A)}return t}var U=u.getToken,D=u.AuthException,F=u.checkLogin,j=function e(){var n=this;E()(this,e),b()(this,"getState",(function(){var e,t;return(null===(e=n.websocket)||void 0===e||null===(t=e.socket)||void 0===t?void 0:t.readyState)||WebSocket.CLOSED})),b()(this,"initSocket",(function(){if(n.websocket)return n;var e=n.url,t=n.onOpen,A=n.onClose,o=n.onError,r=n.onMessage,c=n.onAuthError;return n.websocket=new m({url:e,onOpen:t,onClose:A,onError:o,onMessage:r,connectionHandler:c}),n.connect(),n})),b()(this,"connect",(function(){return n.websocket.createSocket(),n})),b()(this,"reConnect",(function(){setTimeout(n.connect,n.RECONN_TIMEOUT)})),b()(this,"getOrCreate",(function(e,n){return e.get(n)||e.set(n,[]).get(n)})),b()(this,"pushCallback",(function(e,t,A){return n.getOrCreate(e,t).push(A),n})),b()(this,"addSubscriberCallback",(function(e,t){return"function"!=typeof e?n:n.pushCallback(n.sub_callbacks,t,e)})),b()(this,"addEventCallback",(function(e,t,A){if("function"!=typeof t)return n;var o=A?"/".concat(A):"",r="".concat(e).concat(o);return n.pushCallback(n.evt_callbacks,r,t)})),b()(this,"send",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{if(t>=n.RETRIES)throw new Error("Timeout sending message");n.getState()!==WebSocket.OPEN?setTimeout(n.websocket.send,n.RESEND_TIMEOUT,e,t+1):n.websocket.send(JSON.stringify(e))}catch(e){console.error(e)}})),b()(this,"dispatch",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],A=arguments.length>2?arguments[2]:void 0,o=t?n.evt_callbacks:n.sub_callbacks,r=o.get(e)||[];r.forEach((function(e){setTimeout(e,0,A)})),t&&o.delete(e)})),b()(this,"fmtMessage",(function(e,n){return{event:e,pattern:n}})),b()(this,"onOpen",(function(e){n.reSubscribe(),n.dispatch("onopen")})),b()(this,"onClose",(function(e){n.dispatch("onclose"),e.code!==n.NORMAL_CLOSE_EVT&&n.reConnect()})),b()(this,"onError",(function(e){n.dispatch("onerror")})),b()(this,"onAuthError",(function(){n.reConnect()})),b()(this,"onMessage",(function(e){try{var t=JSON.parse(e.data);if(t.error)throw new Error(t.error);var A=t.event,o=Object.values(n.commands).includes(A),r=n.commands;([r.LIST,r.EXECUTE].includes(A)?[A]:t.patterns).forEach((function(e){var r=o?"".concat(A,"/"):"",c="".concat(r).concat(JSON.stringify(e));n.dispatch(c,o,t)}))}catch(e){console.error(e)}})),b()(this,"subscribe",(function(e,t,A){var o=n.commands.SUBSCRIBE,r=n.fmtMessage(o,e),c=JSON.stringify(e);n.initSocket().addSubscriberCallback(t,c).addEventCallback(o,A,c).send(r)})),b()(this,"reSubscribe",(function(){var e=n.commands.SUBSCRIBE;Array.from(n.sub_callbacks.keys()).forEach((function(t){var A=n.fmtMessage(e,JSON.parse(t));n.send(A)}))})),b()(this,"unsubscribe",(function(e,t){var A=n.commands.UNSUBSCRIBE,o=n.fmtMessage(A,e),r=JSON.stringify(e);n.initSocket().addEventCallback(A,t,r).send(o)})),b()(this,"list",(function(e){var t=n.commands.LIST,A=n.fmtMessage(t);n.initSocket().addEventCallback(t,e).send(A)})),b()(this,"execute",(function(e,t,A){var o=n.commands.EXECUTE,r=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach((function(n){b()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({event:o,callback:e},t);n.initSocket().addEventCallback(o,A).send(r)})),b()(this,"onEvent",(function(e,t){n.initSocket().addEventCallback(e,t)})),b()(this,"close",(function(){n.websocket.close(),n.websocket=null})),b()(this,"checkTest",(function(e,t,A,o){return new Promise((function(r,c){n.dispatch(e,t,A,o),r("DONE")}))})),b()(this,"getVar",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"global";if(!["global","fleet"].includes(A))throw"Only fleet and global scopes available.";if("fleet"===A&&e.split("@").length<2)throw"Wrong key format (robot_name@key_name)";var o=n.REST_API+"database/"+A+"/"+e+"/";F().then((function(e){fetch(o).then((function(e){return e.json()})).then((function(e){t&&t(e)}))}))})),b()(this,"setVar",(function(e,t){var A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"global";if(!["global","fleet"].includes(o))throw"Only fleet and global scopes available.";if("fleet"===o){e.split("@");if(e.split("@").length<2)throw"Wrong key format (robot_name@key_name)"}var r={key:e,scope:o,value:t},c=n.REST_API+"database/";F().then((function(e){if(!e)throw new D("login error");fetch(c,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(e){A&&A(e)}))}))})),b()(this,"get",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;F().then((function(t){if(!t)throw new D("login error");fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(e){n&&e.json().then((function(t){n(t,e)})).catch((function(e){n(void 0,e)}))}))}))})),b()(this,"post",(function(e,t,A,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,c=n.REST_API+e+"/"+t+"/";void 0===t&&(c=n.REST_API+e+"/"),F().then((function(e){if(!e)throw new D("login error");fetch(c,{method:"POST",body:JSON.stringify({key:A,data:o}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(e){r&&e.json().then((function(n){r(n,e)})).catch((function(e){r(void 0,e)}))}))}))})),b()(this,"upload",(function(e,t,A){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,r="".concat(n.REST_API,"upload/").concat(e,"/"),c=new FormData;c.append("name",t),c.append("data",A),fetch(r,{method:"POST",body:c,headers:{Authorization:"Bearer ".concat(U())}}).then((function(e){return e.json()})).then(o)})),b()(this,"put",(function(e,t,A){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,r=n.REST_API+e+"/"+t+"/";void 0===t&&(r=n.REST_API+e+"/"),F().then((function(e){if(!e)throw new D("login error");fetch(r,{method:"PUT",body:JSON.stringify(A),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(e){o&&e.json().then((function(n){o(n,e)})).catch((function(n){o(void 0,e)}))}))}))})),b()(this,"delete",(function(e,t){var A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n.REST_API+e+"/"+t+"/";void 0!==t?F().then((function(e){if(!e)throw new D("login error");fetch(r,{method:"DELETE",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(e){A&&e.json().then((function(n){A(n,e)})).catch((function(n){A(void 0,e)}))}))})):r=n.REST_API+e+"/"})),b()(this,"cloudFunction",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",A=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;F().then((function(r){if(!r)throw new D("login error");var c=n.REST_API+"function/"+e+"/";fetch(c,{method:"POST",body:JSON.stringify({func:t,args:A}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(e){o&&e.json().then((function(e){return o(e)}))}))}))})),b()(this,"postTabs",(function(e,t){var A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o="User",r=n.REST_API+o+"/"+e+"/";if(void 0!==e){var c=t.map((function(e){return{componentName:e.componentName,name:e.name}})),i={Workspace:"*"};F().then((function(e){fetch(r,{method:"POST",body:JSON.stringify({key:i,data:c}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(U())}}).then((function(e){A&&e.json().then((function(n){A(n,e)})).catch((function(n){A(void 0,e)}))}))}))}else r=n.REST_API+o+"/"})),this.host="".concat(window.location.hostname,":").concat(window.location.port);var t="https:"===window.location.protocol;this.url="".concat(t?"wss":"ws","://").concat(this.host,"/ws/subscriber"),this.REST_API="".concat(window.location.protocol,"//").concat(this.host,"/api/v1/"),this.RECONN_TIMEOUT=3e3,this.RESEND_TIMEOUT=1e3,this.RETRIES=3,this.NORMAL_CLOSE_EVT=1e3,this.commands={SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",LIST:"list",EXECUTE:"execute"},this.websocket=null,this.sub_callbacks=new Map,this.evt_callbacks=new Map},O=new j,R="\n@font-face {\n  font-family: 'mov.ai';\n  src: url(".concat("data:font/woff;base64,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",') format("woff");\n  font-weight: normal;\n  font-style: normal;\n  font-display: block;\n}\n\n[class^="icon-"], [class*=" icon-"] {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: \'mov.ai\' !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.icon-AddGlobal:before {\n  content: "\\e900";\n}\n.icon-out:before {\n  content: "\\e901";\n}\n.icon-in:before {\n  content: "\\e902";\n}\n.icon-account_circle:before {\n  content: "\\e903";\n}\n.icon-data_setting:before {\n  content: "\\e904";\n}\n.icon-supervisor_account:before {\n  content: "\\e905";\n}\n.icon-add_box:before {\n  content: "\\e906";\n}\n.icon-time .path1:before {\n  content: "\\e907";\n  color: rgb(0, 178, 188);\n}\n.icon-time .path2:before {\n  content: "\\e908";\n  margin-left: -1em;\n  color: rgb(250, 250, 250);\n}\n.icon-carts .path1:before {\n  content: "\\e909";\n  color: rgb(0, 178, 188);\n}\n.icon-carts .path2:before {\n  content: "\\e90a";\n  margin-left: -1em;\n  color: rgb(250, 250, 250);\n}\n.icon-tree_24px:before {\n  content: "\\e90b";\n}\n.icon-expand_more_24px:before {\n  content: "\\e90c";\n}\n.icon-expand_less_24px:before {\n  content: "\\e90d";\n}\n.icon-chevron_right_24px:before {\n  content: "\\e90e";\n}\n.icon-chevron_left_24px:before {\n  content: "\\e90f";\n}\n.icon-Statistics:before {\n  content: "\\e910";\n}\n.icon-Scenes:before {\n  content: "\\e911";\n}\n.icon-Sad:before {\n  content: "\\e912";\n}\n.icon-Normal:before {\n  content: "\\e913";\n}\n.icon-Nodes:before {\n  content: "\\e914";\n}\n.icon-Layouts:before {\n  content: "\\e915";\n}\n.icon-Happy:before {\n  content: "\\e916";\n}\n.icon-Flows:before {\n  content: "\\e917";\n}\n.icon-Filters:before {\n  content: "\\e918";\n}\n.icon-Empty:before {\n  content: "\\e919";\n}\n.icon-Callbacks:before {\n  content: "\\e91a";\n}\n.icon-Annotations:before {\n  content: "\\e91b";\n}\n.icon-create_new_folder_24px:before {\n  content: "\\e91c";\n}\n.icon-widgets_24px:before {\n  content: "\\e91d";\n}\n.icon-log_24px:before {\n  content: "\\e91e";\n}\n.icon-outlined_hidden:before {\n  content: "\\e91f";\n}\n.icon-outlined:before {\n  content: "\\e920";\n}\n.icon-repeat:before {\n  content: "\\e921";\n  color: #2090b7;\n}\n.icon-edit:before {\n  content: "\\e922";\n  color: #2091b7;\n}\n.icon-download:before {\n  content: "\\e923";\n  color: #2091b7;\n}\n.icon-details_24px:before {\n  content: "\\e924";\n}\n.icon-delete:before {\n  content: "\\e925";\n  color: #2091b7;\n}\n.icon-check_circle_24px-copy:before {\n  content: "\\e926";\n}\n.icon-add:before {\n  content: "\\e927";\n  color: #2091b7;\n}\n.icon-drag_indicator-24px-3:before {\n  content: "\\e928";\n}\n'),N=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;E()(this,e),this.size=n,this.undoStack=new P(n),this.redoStack=new P(n)}return p()(e,[{key:"doIt",value:function(e){e.doAction(),this.undoStack.push(e),this.redoStack=new P(this.size)}},{key:"addIt",value:function(e){this.undoStack.push(e),this.redoStack=new P(this.size)}},{key:"undo",value:function(){var e=this.undoStack.pop();e&&(e.undoAction(),this.redoStack.push(e))}},{key:"redo",value:function(){var e=this.redoStack.pop();e&&(e.doAction(),this.undoStack.push(e))}}],[{key:"actionBuilder",value:function(){return new Y}}]),e}(),Y=function(){function e(){E()(this,e),this._doAction=null,this._undoAction=null}return p()(e,[{key:"doAction",value:function(e){return this._doAction=e,this}},{key:"undoAction",value:function(e){return this._undoAction=e,this}},{key:"build",value:function(){if([this._undoAction,this._undoAction].some((function(e){return null==e})))throw"Forgot to set doAction or undoAction";return{doAction:this._doAction,undoAction:this._undoAction}}}]),e}(),P=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;E()(this,e),this.size=n,this.queue=[]}return p()(e,[{key:"push",value:function(e){this.queue.length===this.size&&this.queue.shift(),this.queue.push(e)}},{key:"pop",value:function(){return this.queue.pop()}}]),e}(),x=function(){function e(){if(E()(this,e),e.instance)return e.instance;e.instance=this,this._data={},this.copyKey=Math.random()}return p()(e,[{key:"data",get:function(){return this._data}}],[{key:"clear",value:function(n){var t=new e;n&&delete t._data[n]}},{key:"read",value:function(n){var t=new e;return n?t.data[n]:t.data}},{key:"write",value:function(n,t){return(new e)._data[n]=t}},{key:"copy",value:function(n){e.write((new e).copyKey,n)}},{key:"paste",value:function(){return e.read((new e).copyKey)}}]),e}(),G=function e(){var n=this;E()(this,e),b()(this,"getData",(function(){var e={"Content-Type":"application/json",Authorization:"Bearer ".concat(u.getToken())},t=n.tokenData.message.name,A="".concat(n.baseUrl,"/").concat(t,"/");return new Promise((function(t,o){var r=(new Date).getTime();if(r-n.timestamp<=n.TIMEOUT&&n.data)return t({response:n.data});n.timestamp=r,fetch(A,{headers:e}).then((function(e){e.ok||o({error:e.statusText}),e.json().then((function(e){n.data=e,t({response:e})})).catch((function(e){n.data=null,o({error:e})}))})).catch((function(e){n.data=null,o({error:e})}))}))})),b()(this,"isSuperUser",c()(o.a.mark((function e(){var t,A;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getData();case 2:return A=e.sent,e.abrupt("return",(null==A||null===(t=A.response)||void 0===t?void 0:t.Superuser)||!1);case 4:case"end":return e.stop()}}),e)})))),this.baseUrl="".concat(window.location.origin,"/api/v1/User"),this.tokenData=u.getTokenData(),this.data=null,this.timestamp=null,this.TIMEOUT=3e3},H=t(6),_=t(3),J=t.n(_),V=function(){function e(n,t,A,o){var r=this;E()(this,e),b()(this,"_initialize",(function(){return r.patterns.forEach((function(e){return r._subscribe(e)})),r})),b()(this,"_subscribe",(function(e){r.db.subscribe(e,(function(e){return r._onDataChange(e)}),(function(e){return r._onDataLoad(e)}))})),b()(this,"_validatePatterns",(function(e){var n={Scope:r.model,Name:"*"},t=e||n;return Array.isArray(t)?t:[t]})),b()(this,"get",(function(e){return r._cache.get(e)})),b()(this,"getAll",(function(){return r._cache.values()})),b()(this,"_get_or_create",(function(e){return r.get(e)||r.add(e,{name:e,obj:{},id:e}).get(e)})),b()(this,"add",(function(e,n){return r._cache.set(e,n)})),b()(this,"remove",(function(e){r._cache.delete(e)})),b()(this,"destroy",(function(){r.patterns.forEach((function(e){return r.db.unsubscribe(e)}))})),b()(this,"removeEmpty",(function(e,n){var t=null;if(J.a.isEmpty(J.a.get(e,n,{}))){t=J.a.omit(e,n);var A=n.split(".");A.length>1&&(t=r.removeEmpty(t,A.slice(0,-1).join(".")))}return t||e})),b()(this,"_onDataChange",(function(e){var n=J.a.get(e,"key.".concat(r.model),{});Object.keys(n).forEach((function(t){var A=r._get_or_create(t);if("del"===e.event){var o=Object.keys(f.flattenObject(n[t]))[0];A.obj=r.removeEmpty(J.a.omit(A.obj,o),o),J.a.isEmpty(A.obj)&&r.remove(t)}else J.a.merge(A.obj,n[t]);r._subject.next({data:A,event:e.event})}))})),b()(this,"_onDataLoad",(function(e){var n=J.a.get(e,"value.".concat(r.model),{});Object.keys(n).forEach((function(e){var t=r._get_or_create(e);J.a.merge(t.obj,n[e])})),--r.nr_patterns<=0&&(r.db_state=r.db_states.ready)})),b()(this,"onReady",(function(e){r.db_state!==r.db_states.ready?r._subject_state.subscribe((function(){}),(function(){}),(function(){return e()})):e()})),b()(this,"onUpdate",(function(e){r._subject.subscribe(e)})),this.db_states=Object.freeze({error:-1,loading:0,ready:1}),this.db=A,this.model=t,this.manager=n,this._subject=new H.Subject,this._cache=new Map,this._subject_state=new H.BehaviorSubject(0),this._db_state=this.db_states.loading,this.patterns=this._validatePatterns(o),this.nr_patterns=this.patterns.length,this._initialize()}return p()(e,[{key:"db_state",get:function(){return this._db_state},set:function(e){e!==this._db_state&&(this._db_state=e,e!==this.db_states.ready?this._subject_state.next(e):this._subject_state.complete())}}]),e}(),z=function(){function e(){var n=this;E()(this,e),b()(this,"_initialize",(function(){if(J.a.isEmpty(n.models))throw new Error("No models added");return Object.keys(n.models).forEach((function(e){var t=e.charAt(0).toLowerCase()+e.slice(1);Object.defineProperty(n,t,{get:function(){return n.models[e]}})})),n._subscribeModelsReady()})),b()(this,"_subscribeModelsReady",(function(){return Object.keys(n.models).forEach((function(e){n.models[e].onReady((function(){return n._setModelReady(e)}))})),n})),b()(this,"_setModelReady",(function(e){n.isReady+=1,n.isReady===Object.keys(n.models).length&&n._subject_state.complete()})),b()(this,"onUpdate",(function(e,n){return e.onUpdate(n)})),b()(this,"onReady",(function(e){n.db_state!==n.db_states.ready?n._subject_state.subscribe((function(){}),(function(){}),(function(){return e()})):e()})),this.models={},this.db_states=Object.freeze({error:-1,loading:0,ready:1}),this.isReady=0,this._subject_state=new H.BehaviorSubject(0)}return p()(e,[{key:"db_state",get:function(){return this.isReady===Object.keys(this.models).length?this.db_states.ready:this.db_states.loading}}]),e}(),L=t(7),K=t.n(L),W={encodeURI:function(e){for(var n={},t=0,A=Object.entries(e);t<A.length;t++){var o=K()(A[t],2),r=o[0],c=o[1];n[r]=encodeURIComponent(c)}return n},getUrl:function(e){var n=e.path,t=e.search,A=void 0===t?{}:t,o="".concat(window.location.hostname,":").concat(window.location.port),r=new URLSearchParams(W.encodeURI(A));return"".concat(window.location.protocol,"//").concat(o,"/api/").concat(n,"?").concat(r.toString())},_request:function(e){var n=e.path,t=e.method,A=void 0===t?"GET":t,o=e.body,r=void 0===o?{}:o,c=e.search,i=e.customHeaders,a=void 0===i?{}:i,s=W.getUrl({path:n,search:c}),u={method:A,headers:a};return console.log("payload",u),["HEAD","GET"].includes(A)||(u.body=JSON.stringify(r)),fetch(s,u).then((function(e){return e.ok?e.json():Promise.reject(e)}))},get:function(e){var n=e.path,t=e.search,A=e.customHeaders,o=void 0===A?{}:A;return W._request({path:n,search:t,customHeaders:o})},post:function(e){var n=e.path,t=e.body,A=e.customHeaders,o=void 0===A?{}:A;return W._request({path:n,method:"POST",body:t,customHeaders:o})},put:function(e){var n=e.path,t=e.body,A=e.customHeaders,o=void 0===A?{}:A;return W._request({path:n,method:"PUT",body:t,customHeaders:o})},delete:function(e){var n=e.path,t=e.body,A=e.customHeaders,o=void 0===A?{}:A;return W._request({path:n,method:"DELETE",body:t,customHeaders:o})},upload:function(e){var n=e.packageName,t=e.key,A=e.value,o=e.customHeaders,r=void 0===o?{}:o,c="upload/".concat(n,"/"),i=new FormData;return i.append("name",t),i.append("data",A),W.post({path:c,body:i,customHeaders:r})},cloudFunction:function(e){var n=e.cbName,t=e.func,A=void 0===t?"":t,o=e.args,r=e.customHeaders,c=void 0===r?{}:r,i="function/".concat(n,"/"),a={func:A,args:o};return W.post({path:i,body:a,customHeaders:c}).then((function(e){return e.json()}))},validScope:function(e){return["global","fleet"].includes(e)},validKey:function(e){return e.split("@")>=2},validateVar:function(e,n){[{fn:function(e){return W.validScope(e)},error:"Invalid scope"},{fn:function(e){return W.validKey(e)},error:"Key format should be <robot name>@<key name>"}].forEach((function(e){if(!e.fn())throw new Error(e.error)}))},getVar:function(e){var n=e.key,t=e.scope,A=void 0===t?"global":t,o=e.customHeaders,r=void 0===o?{}:o;W.validateVar(n,A);var c="v1/database/".concat(A,"/").concat(n,"/");return W.get({path:c,customHeaders:r}).then((function(e){return e.json()}))},setVar:function(e){var n=e.key,t=e.value,A=e.scope,o=void 0===A?"global":A,r=e.customHeaders,c=void 0===r?{}:r;W.validateVar(n,o);var i={key:n,scope:o,value:t};return W.post({path:"v1/database/",body:i,customHeaders:c}).then((function(e){return e.json()}))}},q=W;function X(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(e);n&&(A=A.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,A)}return t}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?X(Object(t),!0).forEach((function(n){b()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var $=u.checkLogin,ee=u.AuthException,ne=u.getToken,te=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={__checkLogin:function(e,n){return function(t){return $().then((function(A){if(!A)throw new ee("Login error");var o={"Content-Type":"application/json",Authorization:"Bearer ".concat(ne())};return Reflect.get(e,n)(Z({customHeaders:o},t))}))}},get:function(e,n){return this.__checkLogin(e,n)}};return new Proxy(Object.assign(e,n),t)}(q),Ae={create:function(e){var n=e.target,t=e.source,A={src:"".concat(t.workspace,"/").concat(t.type,"/").concat(t.name,"/").concat(t.version,"/")},o="v2/db/".concat(n.workspace||t.workspace,"/").concat(n.type,"/").concat(n.name,"/").concat(n.version,"/");return te.post({path:o,body:A})},delete:function(){throw new Error("Not implemented")},read:function(e){var n=e.workspace,t=e.type,A=e.name,o=e.version,r="v2/db/".concat(n,"/").concat(t,"/").concat(A,"/").concat(o,"/");return te.get({path:r})},restore:function(e){var n=e.target,t=e.source;return n.workspace="global",Ae.create({target:n,source:t})},getAll:function(e){var n=e.workspace,t=e.type,A=e.name,o="v2/db/".concat(n,"/").concat(t,"/").concat(A,"/");return te.get({path:o})}},oe=Ae,re=function(){function e(n){var t=this,A=n.type,o=n.name,r=n.workspace,c=void 0===r?"global":r,i=n.version,a=n.uri,s=n.apiVersion,u=void 0===s?"v1":s;E()(this,e),b()(this,"_init",(function(e,n,A,o,r,c){t._parseArgs(A,e,n,o,r),t.subscriber=void 0,t.database=O,t.data={},t.apiVersion=c})),b()(this,"_parseArgs",(function(e,n,A,o,r){var c=(r||"").split("/"),i=K()(c,4),a=i[0],s=i[1],u=i[2],h=i[3];t.workspace=a||e,t.type=s||n,t.name=u||A,t.version=h||o})),b()(this,"read",(function(){var e=t.workspace,n=t.type,A=t.name,o=t.version,r=t.apiVersion,c={v1:"v1/".concat(n,"/").concat(A,"/"),v2:"v2/db/".concat(e,"/").concat(n,"/").concat(A,"/").concat(o,"/")}[r];return te.get({path:c}).then((function(e){return t.data=e,e}))})),b()(this,"update",(function(e){var n=t.type,A=t.name,o=t.apiVersion,r={v1:"v1/".concat(n,"/").concat(A,"/"),v2:"v2/db/".concat(workspace,"/").concat(n,"/").concat(A,"/").concat(version,"/")}[o];return te.put({path:r,body:e})})),b()(this,"subscribe",(function(e){t.resubscribe(e)})),b()(this,"resubscribe",(function(e){t.readOnly||(t.unsubscribe(),t.subscriber=new V({},t.type,t.database,[{Scope:t.type,Name:t.name}]),t.subscriber.onUpdate((function(){var n;t.data=(null===(n=t.subscriber.get(t.name))||void 0===n?void 0:n.obj)||{},e(t.data)})))})),b()(this,"unsubscribe",(function(){t.subscriber&&t.subscriber.destroy(),t.subscriber=null})),b()(this,"createSnapshot",(function(e){var n=e.trgWorkspace,A=e.version,o=t.workspace,r=t.type,c=t.name;return oe.create({trgWorkspace:n,srcWorkspace:o,type:r,name:c,version:A})})),b()(this,"getSnapShots",(function(){var e=t.workspace,n=t.type,A=t.name;return oe.getAll({workspace:e,type:n,name:A})})),this._init(A,o,c,i,a,u)}return p()(e,[{key:"readOnly",get:function(){return Boolean(this.version)}}],[{key:"create",value:function(e){var n=e.type,t=e.name,A=e.apiVersion,o=void 0===A?"v1":A,r=e.workspace,c={v1:"v1/".concat(n,"/"),v2:"v2/db/".concat(r,"/").concat(n,"/").concat(t,"/")}[o],i={v1:{data:{Label:t}},v2:{Label:t}}[o];return te.post({path:c,body:i})}},{key:"delete",value:function(e){var n=e.type,t=e.name,A=e.body,o=e.apiVersion,r=void 0===o?"v1":o,c=e.workspace,i=void 0===c?"global":c,a={v1:"v1/".concat(n,"/").concat(t,"/"),v2:"v2/db/".concat(i,"/").concat(n,"/").concat(t,"/")}[r];return te.delete({path:a,body:A})}},{key:"getAll",value:function(e){var n=e.workspace,t=e.type,A=t?"".concat(t,"/"):"",o="v2/db/".concat(n,"/").concat(A);return te.get({path:o})}}]),e}(),ce={create:function(){throw new Error("Not implemented")},delete:function(){throw new Error("Not implemented")},getAll:function(){return te.get({path:"v2/db/"})}},ie=ce}])}));
//# sourceMappingURL=index.js.map